(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{6896:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return n(5625)}])},2645:function(e,t,n){"use strict";n.d(t,{XM:function(){return calculateFees},aA:function(){return i},p_:function(){return o}});let a=[{min:0,max:100,addPrice:6,promoPrice:4},{min:101,max:300,addPrice:6,promoPrice:10.99},{min:301,max:1e3,addPrice:6,promoPrice:15},{min:1001,max:1/0,addPrice:6,promoPrice:0}],o={PRO:{name:"Wersja PRO",price:15,features:["Nielimitowane darmowe ogłoszenia","Brak reklam na stronie","Statystyki wyświetleń ogłoszeń","Priorytetowe wsparcie techniczne","Wyr\xf3żniony status na profilu"],promotions:3,freePromotions:!0},PRO_PLUS:{name:"Wersja PRO+",price:25,features:["Wszystko z wersji PRO","Nielimitowane darmowe ogłoszenia","Nieograniczone darmowe promowanie ogłoszeń","Wyr\xf3żnione ramki wok\xf3ł ogłoszeń","Najwyższy priorytet w wynikach wyszukiwania","Dedykowane wsparcie techniczne"],promotions:-1,freePromotions:!0}},i={ogrodnictwo:{name:"Ogrodnictwo",subcategories:["Koszenie trawy","Pielęgnacja roślin","Sadzenie kwiat\xf3w","Przycinanie drzew","Sprzątanie liści","Nawożenie","Projektowanie ogrod\xf3w"]},sprzatanie:{name:"Sprzątanie",subcategories:["Mycie okien","Odkurzanie","Pranie dywan\xf3w","Sprzątanie po remoncie","Generalne sprzątanie","Prasowanie","Mycie elewacji"]},transport:{name:"Transport",subcategories:["Przeprowadzki","Dostawy","Przew\xf3z os\xf3b","Transport mebli","Kurierskie","Przeprowadzki biurowe"]},budowlane:{name:"Prace budowlane",subcategories:["Malowanie","Układanie płytek","Elektryczne","Hydrauliczne","Tynkowanie","Glazura","Izolacje"]},it:{name:"IT i technologie",subcategories:["Naprawa komputer\xf3w","Instalacja oprogramowania","Projektowanie stron","Pomoc techniczna","Konfiguracja sieci","Odzyskiwanie danych","Szkolenia IT"]},opieka:{name:"Opieka",subcategories:["Opieka nad dziećmi","Opieka nad zwierzętami","Korepetycje","Tłumaczenia","Fotografowanie","Catering","Masaże","Fryzjerstwo"]},inne:{name:"Inne",subcategories:["Usługi księgowe","Pomoc prawna","Organizacja imprez","Usługi marketingowe","Konsultacje","Fotografia","Catering","Masaże","Fryzjerstwo","R\xf3żne"]}};function calculateFees(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=function(e){let t=a.find(t=>e>=t.min&&e<=t.max);return t||a[a.length-1]}(e);return{addPrice:n.addPrice,promoPrice:t?n.promoPrice:0,total:n.addPrice+(t?n.promoPrice:0)}}},5625:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Profile}});var a=n(5893),o=n(7294),i=n(1163),s=n(1372),r=n(5003),c=n.n(r),l=n(1285),d=n.n(l);function ChatList(e){let{onSelect:t,onChatDeleted:n}=e,[i,s]=(0,o.useState)([]),[r,c]=(0,o.useState)(null);(0,o.useEffect)(()=>{loadChats()},[]);let loadChats=()=>{fetch("/api/auth/chats",{credentials:"include"}).then(async e=>{if(!e.ok)return console.error("Błąd API chats:",e.status,e.statusText),[];try{let t=await e.json();return console.log("Pobrano chaty:",t),t}catch(e){return console.error("Invalid JSON from /api/auth/chats:",e),[]}}).then(s).catch(e=>{console.error("ChatList fetch error:",e),s([])})},handleSelect=e=>{c(e),t(e)},getInitials=e=>e.charAt(0).toUpperCase();return 0===i.length?(0,a.jsxs)("div",{className:d().emptyState,children:[(0,a.jsx)("div",{className:d().icon,children:"\uD83D\uDCAC"}),(0,a.jsx)("p",{children:"Brak rozm\xf3w"}),(0,a.jsx)("p",{children:'Rozpocznij rozmowę klikając "Napisz wiadomość" przy ofercie'})]}):(0,a.jsx)("ul",{className:d().list,children:i.map(e=>(0,a.jsxs)("li",{className:"".concat(d().chatItem," ").concat(r===e.chatId?d().selected:""),onClick:()=>handleSelect(e.chatId),children:[(0,a.jsx)("div",{className:d().avatar,children:getInitials(e.withUser)}),(0,a.jsxs)("div",{className:d().chatInfo,children:[(0,a.jsx)("h4",{className:d().userName,children:e.withUser}),(0,a.jsx)("p",{className:d().lastMessage,children:e.lastMessage||"Brak wiadomości"})]}),(0,a.jsx)("div",{className:d().chatActions,children:(0,a.jsx)("div",{className:d().timestamp,children:"teraz"})})]},e.chatId))})}var u=n(2457),m=n.n(u);function ChatWindow(e){let{chatId:t,offerId:n,onChatDeleted:i}=e,[s,r]=(0,o.useState)([]),[c,l]=(0,o.useState)(""),[d,u]=(0,o.useState)(null),p=(0,o.useRef)(null),h=(0,o.useRef)(null),handleDeleteChat=async()=>{if(confirm("Czy na pewno chcesz usunąć tę rozmowę? Wszystkie wiadomości zostaną utracone."))try{let e=await fetch("/api/chats/".concat(t,"/delete"),{method:"DELETE",credentials:"include"});if(e.ok)null==i||i(t),alert("Rozmowa została usunięta");else{let t=await e.json();alert("Błąd: ".concat(t.error||"Nie udało się usunąć rozmowy"))}}catch(e){console.error("Błąd usuwania rozmowy:",e),alert("Wystąpił błąd podczas usuwania rozmowy")}};(0,o.useEffect)(()=>{fetch("/api/chats/".concat(t),{credentials:"include"}).then(async e=>{if(!e.ok)return[];try{return await e.json()}catch(e){return console.error("Invalid JSON from /api/chats/".concat(t)),[]}}).then(r).catch(e=>{console.error("ChatWindow fetch error:",e),r([])}).finally(()=>{setTimeout(()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.scrollIntoView()},0)})},[t]);let send=()=>{c.trim()&&fetch("/api/chats/".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({text:c})}).then(async e=>{if(!e.ok)throw Error("Send failed");try{return await e.json()}catch(e){return console.error("Invalid JSON on POST /api/chats/"+t),null}}).then(e=>{e&&(r(t=>[...t,e]),l(""),setTimeout(()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.scrollIntoView()},0))}).catch(e=>console.error("ChatWindow send error:",e))},sendFile=async()=>{if(!d)return;let e=new FormData;e.append("file",d);try{let n=await fetch("/api/chats/".concat(t,"/upload"),{method:"POST",credentials:"include",body:e});if(n.ok){let e=await n.json();r(t=>[...t,e]),u(null),h.current&&(h.current.value=""),setTimeout(()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.scrollIntoView()},0)}}catch(e){console.error("File upload error:",e)}},renderMessageContent=e=>{if(e.startsWith("[IMAGE: ")){var t;let n=null===(t=e.match(/\[IMAGE: (.+?)\]/))||void 0===t?void 0:t[1];if(n)return(0,a.jsx)("img",{src:n,alt:"Załącznik",className:m().messageImage,onClick:()=>window.open(n,"_blank")})}return e};return(0,a.jsxs)("div",{className:m().window,children:[(0,a.jsxs)("div",{className:m().header,children:[(0,a.jsx)("div",{className:m().avatar,children:"U"}),(0,a.jsxs)("div",{className:m().userInfo,children:[(0,a.jsx)("h4",{children:"Rozmowa"}),(0,a.jsx)("p",{children:"Aktywny"})]}),(0,a.jsxs)("div",{className:m().headerActions,children:[(0,a.jsx)("button",{className:m().offerButton,onClick:()=>{if(console.log("\uD83D\uDD0D handleViewOffer called, offerId:",n),n){let e="/?offerId=".concat(n);console.log("\uD83D\uDE80 Redirecting to:",e),window.location.href=e}else console.warn("⚠️ No offerId available"),alert("Brak informacji o ofercie powiązanej z tą rozmową.")},disabled:!n,children:"\uD83D\uDCCB Zobacz ofertę"}),(0,a.jsx)("button",{className:m().deleteButton,onClick:handleDeleteChat,title:"Usuń rozmowę",children:"\uD83D\uDDD1️"})]})]}),(0,a.jsxs)("div",{className:m().messages,children:[0===s.length?(0,a.jsxs)("div",{className:m().emptyState,children:[(0,a.jsx)("div",{className:m().icon,children:"\uD83D\uDCAC"}),(0,a.jsx)("p",{children:"Brak wiadomości. Napisz pierwszą wiadomość!"})]}):s.map(e=>(0,a.jsxs)("div",{className:"".concat(m().message," ").concat(e.fromMe?m().me:m().them),children:[renderMessageContent(e.text),(0,a.jsx)("div",{className:m().timestamp,children:new Date().toLocaleTimeString("pl-PL",{hour:"2-digit",minute:"2-digit"})})]},e.id)),(0,a.jsx)("div",{ref:p})]}),(0,a.jsxs)("div",{className:m().inputRow,children:[(0,a.jsx)("input",{ref:h,type:"file",accept:"image/*",onChange:e=>{var t;let n=null===(t=e.target.files)||void 0===t?void 0:t[0];n&&u(n)},style:{display:"none"}}),(0,a.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.click()},className:m().attachButton,title:"Załącz zdjęcie",children:"\uD83D\uDCCE"}),d&&(0,a.jsxs)("div",{className:m().filePreview,children:[(0,a.jsx)("span",{children:d.name}),(0,a.jsx)("button",{onClick:()=>u(null),children:"✕"})]}),(0,a.jsx)("input",{value:c,onChange:e=>l(e.target.value),placeholder:"Napisz wiadomość…",onKeyPress:e=>"Enter"===e.key&&send()}),d?(0,a.jsx)("button",{onClick:sendFile,className:m().sendButton,children:"Wyślij zdjęcie"}):(0,a.jsx)("button",{onClick:send,disabled:!c.trim(),className:m().sendButton,children:"Wyślij"})]})]})}var p=n(2682),h=n(1228),f=n.n(h);function AccountSettings(e){let{user:t}=e,[n,i]=(0,o.useState)("security"),[s,r]=(0,o.useState)(!1),[c,l]=(0,o.useState)(null),[d,u]=(0,o.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[m,p]=(0,o.useState)({theme:"natura",language:"pl",emailNotifications:!0,pushNotifications:!1}),[h,_]=(0,o.useState)(""),[g,x]=(0,o.useState)({emailOffers:!0,emailMessages:!0,emailPromotions:!1,pushOffers:!1,pushMessages:!0,pushPromotions:!1}),[j,y]=(0,o.useState)({totalOffers:0,totalMessages:0,accountAge:0,lastLogin:""});(0,o.useEffect)(()=>{t&&y({totalOffers:Math.floor(20*Math.random())+1,totalMessages:Math.floor(50*Math.random())+5,accountAge:Math.floor(365*Math.random())+30,lastLogin:new Date().toISOString()})},[t]);let handleChangePassword=async e=>{if(e.preventDefault(),r(!0),l(null),d.newPassword!==d.confirmPassword){l({type:"error",text:"Nowe hasła nie są identyczne"}),r(!1);return}try{var t;let e=null===(t=document.cookie.split(";").find(e=>e.startsWith("token=")))||void 0===t?void 0:t.split("=")[1],n=await fetch("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({currentPassword:d.currentPassword,newPassword:d.newPassword})}),a=await n.json();n.ok?(l({type:"success",text:"Hasło zostało zmienione"}),u({currentPassword:"",newPassword:"",confirmPassword:""})):l({type:"error",text:a.error||"Błąd podczas zmiany hasła"})}catch(e){l({type:"error",text:"Błąd podczas zmiany hasła"})}r(!1)},handleUpdatePreferences=async e=>{e.preventDefault(),r(!0),l(null);try{await new Promise(e=>setTimeout(e,1e3)),l({type:"success",text:"Preferencje zostały zapisane"})}catch(e){l({type:"error",text:"Błąd podczas zapisywania preferencji"})}r(!1)},handleUpdateNotifications=async e=>{e.preventDefault(),r(!0),l(null);try{await new Promise(e=>setTimeout(e,1e3)),l({type:"success",text:"Ustawienia powiadomień zostały zapisane"})}catch(e){l({type:"error",text:"Błąd podczas zapisywania ustawień"})}r(!1)},handleLogoutAllDevices=async()=>{if(window.confirm("Czy na pewno chcesz wylogować się ze wszystkich urządzeń?")){r(!0);try{var e;let t=null===(e=document.cookie.split(";").find(e=>e.startsWith("token=")))||void 0===e?void 0:e.split("=")[1];await fetch("/api/auth/logout-all",{method:"POST",headers:{Authorization:"Bearer ".concat(t)}}),document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",localStorage.clear(),sessionStorage.clear(),l({type:"success",text:"Wylogowano ze wszystkich urządzeń"}),setTimeout(()=>{window.location.href="/login"},2e3)}catch(e){l({type:"error",text:"Błąd podczas wylogowywania"})}r(!1)}},handleDeleteAccount=async()=>{if(!window.confirm("Czy na pewno chcesz usunąć konto? Ta operacja jest nieodwracalna."))return;let e=window.prompt('Wpisz "USUŃ KONTO" aby potwierdzić:');if("USUŃ KONTO"!==e){l({type:"error",text:"Nieprawidłowe potwierdzenie"});return}r(!0);try{var t;let e=null===(t=document.cookie.split(";").find(e=>e.startsWith("token=")))||void 0===t?void 0:t.split("=")[1],n=await fetch("/api/auth/delete-account",{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}});if(n.ok)document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",localStorage.clear(),sessionStorage.clear(),alert("Konto zostało usunięte"),window.location.href="/login";else{let e=await n.json();l({type:"error",text:e.error||"Błąd podczas usuwania konta"})}}catch(e){l({type:"error",text:"Błąd podczas usuwania konta"})}r(!1)};return(0,a.jsxs)("div",{className:f().accountSettings,children:[c&&(0,a.jsx)("div",{className:"".concat(f().message," ").concat("success"===c.type?f().success:f().error),children:c.text}),(0,a.jsxs)("div",{className:f().settingsContainer,children:[(0,a.jsxs)("div",{className:f().sidebar,children:[(0,a.jsx)("button",{className:"".concat(f().navButton," ").concat("security"===n?f().active:""),onClick:()=>i("security"),children:"\uD83D\uDD12 Bezpieczeństwo"}),(0,a.jsx)("button",{className:"".concat(f().navButton," ").concat("preferences"===n?f().active:""),onClick:()=>i("preferences"),children:"\uD83C\uDFA8 Preferencje"}),(0,a.jsx)("button",{className:"".concat(f().navButton," ").concat("notifications"===n?f().active:""),onClick:()=>i("notifications"),children:"\uD83D\uDD14 Powiadomienia"}),(0,a.jsx)("button",{className:"".concat(f().navButton," ").concat("account"===n?f().active:""),onClick:()=>i("account"),children:"\uD83D\uDC64 Informacje o koncie"})]}),(0,a.jsxs)("div",{className:f().content,children:["security"===n&&(0,a.jsxs)("div",{className:f().section,children:[(0,a.jsx)("h3",{children:"Bezpieczeństwo konta"}),(0,a.jsxs)("div",{className:f().securityActions,children:[(0,a.jsxs)("form",{onSubmit:handleChangePassword,className:f().changePasswordForm,children:[(0,a.jsx)("h4",{children:"Zmiana hasła"}),(0,a.jsxs)("div",{className:f().formGroup,children:[(0,a.jsx)("label",{children:"Obecne hasło"}),(0,a.jsx)("input",{type:"password",value:d.currentPassword,onChange:e=>u({...d,currentPassword:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{className:f().formGroup,children:[(0,a.jsx)("label",{children:"Nowe hasło"}),(0,a.jsx)("input",{type:"password",value:d.newPassword,onChange:e=>u({...d,newPassword:e.target.value}),required:!0,minLength:6})]}),(0,a.jsxs)("div",{className:f().formGroup,children:[(0,a.jsx)("label",{children:"Powt\xf3rz nowe hasło"}),(0,a.jsx)("input",{type:"password",value:d.confirmPassword,onChange:e=>u({...d,confirmPassword:e.target.value}),required:!0,minLength:6})]}),(0,a.jsx)("button",{type:"submit",className:f().primaryButton,disabled:s,children:s?"Zapisywanie...":"Zmień hasło"})]}),(0,a.jsxs)("div",{className:f().securityOptions,children:[(0,a.jsx)("h4",{children:"Opcje bezpieczeństwa"}),(0,a.jsx)("button",{onClick:handleLogoutAllDevices,className:f().warningButton,disabled:s,children:"\uD83D\uDEAA Wyloguj ze wszystkich urządzeń"})]})]})]}),"preferences"===n&&(0,a.jsxs)("div",{className:f().section,children:[(0,a.jsx)("h3",{children:"Preferencje"}),(0,a.jsxs)("form",{onSubmit:handleUpdatePreferences,className:f().preferencesForm,children:[(0,a.jsxs)("div",{className:f().formGroup,children:[(0,a.jsx)("label",{children:"Motyw"}),(0,a.jsxs)("select",{value:m.theme,onChange:e=>p({...m,theme:e.target.value}),children:[(0,a.jsx)("option",{value:"light",children:"Jasny"}),(0,a.jsx)("option",{value:"dark",children:"Ciemny"}),(0,a.jsx)("option",{value:"night",children:"Nocny"}),(0,a.jsx)("option",{value:"natura",children:"Natura"})]})]}),(0,a.jsxs)("div",{className:f().formGroup,children:[(0,a.jsx)("label",{children:"Język"}),(0,a.jsxs)("select",{value:m.language,onChange:e=>p({...m,language:e.target.value}),children:[(0,a.jsx)("option",{value:"pl",children:"Polski"}),(0,a.jsx)("option",{value:"en",children:"English"})]})]}),(0,a.jsx)("button",{type:"submit",className:f().primaryButton,disabled:s,children:s?"Zapisywanie...":"Zapisz preferencje"})]})]}),"notifications"===n&&(0,a.jsxs)("div",{className:f().section,children:[(0,a.jsx)("h3",{children:"Powiadomienia"}),(0,a.jsxs)("form",{onSubmit:handleUpdateNotifications,className:f().notificationsForm,children:[(0,a.jsxs)("div",{className:f().notificationGroup,children:[(0,a.jsx)("h4",{children:"Powiadomienia email"}),(0,a.jsxs)("label",{className:f().checkbox,children:[(0,a.jsx)("input",{type:"checkbox",checked:g.emailOffers,onChange:e=>x({...g,emailOffers:e.target.checked})}),"Nowe ogłoszenia w interesujących kategoriach"]}),(0,a.jsxs)("label",{className:f().checkbox,children:[(0,a.jsx)("input",{type:"checkbox",checked:g.emailMessages,onChange:e=>x({...g,emailMessages:e.target.checked})}),"Nowe wiadomości"]}),(0,a.jsxs)("label",{className:f().checkbox,children:[(0,a.jsx)("input",{type:"checkbox",checked:g.emailPromotions,onChange:e=>x({...g,emailPromotions:e.target.checked})}),"Promocje i oferty specjalne"]})]}),(0,a.jsxs)("div",{className:f().notificationGroup,children:[(0,a.jsx)("h4",{children:"Powiadomienia push"}),(0,a.jsxs)("label",{className:f().checkbox,children:[(0,a.jsx)("input",{type:"checkbox",checked:g.pushOffers,onChange:e=>x({...g,pushOffers:e.target.checked})}),"Nowe ogłoszenia"]}),(0,a.jsxs)("label",{className:f().checkbox,children:[(0,a.jsx)("input",{type:"checkbox",checked:g.pushMessages,onChange:e=>x({...g,pushMessages:e.target.checked})}),"Nowe wiadomości"]}),(0,a.jsxs)("label",{className:f().checkbox,children:[(0,a.jsx)("input",{type:"checkbox",checked:g.pushPromotions,onChange:e=>x({...g,pushPromotions:e.target.checked})}),"Promocje"]})]}),(0,a.jsx)("button",{type:"submit",className:f().primaryButton,disabled:s,children:s?"Zapisywanie...":"Zapisz ustawienia"})]})]}),"account"===n&&(0,a.jsxs)("div",{className:f().section,children:[(0,a.jsx)("h3",{children:"Informacje o koncie"}),(0,a.jsxs)("div",{className:f().accountInfo,children:[(0,a.jsxs)("div",{className:f().infoItem,children:[(0,a.jsx)("label",{children:"Email"}),(0,a.jsx)("div",{className:f().infoValue,children:null==t?void 0:t.email})]}),(0,a.jsxs)("div",{className:f().infoItem,children:[(0,a.jsx)("label",{children:"Typ konta"}),(0,a.jsx)("div",{className:f().infoValue,children:(null==t?void 0:t.isAdmin)?(0,a.jsx)("span",{className:f().adminBadge,children:"Administrator"}):(0,a.jsx)("span",{className:f().userBadge,children:"Użytkownik"})})]}),(0,a.jsxs)("div",{className:f().infoItem,children:[(0,a.jsx)("label",{children:"Ostatnie logowanie"}),(0,a.jsx)("div",{className:f().infoValue,children:j.lastLogin?new Date(j.lastLogin).toLocaleString("pl-PL"):"Nieznane"})]})]}),(0,a.jsxs)("div",{className:f().dangerZone,children:[(0,a.jsx)("h4",{children:"Strefa niebezpieczna"}),(0,a.jsx)("button",{onClick:handleDeleteAccount,className:f().dangerButton,disabled:s,children:"\uD83D\uDDD1️ Usuń konto na zawsze"}),(0,a.jsx)("p",{className:f().dangerWarning,children:"Ta operacja jest nieodwracalna. Wszystkie Twoje dane zostaną usunięte."})]})]})]})]})]})}var _=n(8940),g=n.n(_);function UserRatings(e){let{userEmail:t}=e,[n,i]=(0,o.useState)([]),[s,r]=(0,o.useState)(0),[c,l]=(0,o.useState)(0),[d,u]=(0,o.useState)(!0);(0,o.useEffect)(()=>{fetchRatings()},[t]);let fetchRatings=async()=>{try{let e=await fetch("/api/ratings/get?userEmail=".concat(encodeURIComponent(t)));if(e.ok){let t=await e.json();i(t.ratings),r(t.averageRating),l(t.totalRatings)}}catch(e){console.error("Error fetching ratings:",e)}finally{u(!1)}},renderStars=e=>{let t=[];for(let n=1;n<=5;n++)t.push((0,a.jsx)("span",{className:"".concat(g().star," ").concat(n<=e?g().filled:""),children:"⭐"},n));return t},formatDate=e=>new Date(e).toLocaleDateString("pl-PL",{day:"numeric",month:"long",year:"numeric"});return d?(0,a.jsx)("div",{className:g().ratingsContainer,children:(0,a.jsx)("div",{className:g().loadingSpinner,children:"Ładowanie ocen..."})}):(0,a.jsxs)("div",{className:g().ratingsContainer,children:[(0,a.jsxs)("div",{className:g().ratingsHeader,children:[(0,a.jsx)("h3",{children:"Oceny użytkownika"}),c>0?(0,a.jsxs)("div",{className:g().averageRating,children:[(0,a.jsx)("div",{className:g().averageStars,children:renderStars(Math.round(s))}),(0,a.jsxs)("span",{className:g().averageText,children:[s.toFixed(1)," (",c," ",1===c?"ocena":c<5?"oceny":"ocen",")"]})]}):(0,a.jsx)("div",{className:g().noRatings,children:(0,a.jsx)("span",{children:"Brak ocen"})})]}),n.length>0&&(0,a.jsx)("div",{className:g().ratingsList,children:n.map(e=>(0,a.jsxs)("div",{className:g().ratingItem,children:[(0,a.jsxs)("div",{className:g().ratingHeader,children:[(0,a.jsx)("div",{className:g().ratingStars,children:renderStars(e.rating)}),(0,a.jsx)("div",{className:g().ratingDate,children:formatDate(e.createdAt)})]}),e.comment&&(0,a.jsxs)("div",{className:g().ratingComment,children:['"',e.comment,'"']}),(0,a.jsxs)("div",{className:g().ratingMeta,children:[(0,a.jsxs)("span",{className:g().reviewer,children:["przez ",e.reviewer.name||e.reviewer.email]}),e.offer&&(0,a.jsxs)("span",{className:g().offerTitle,children:['za "',e.offer.title,'"']})]})]},e.id))})]})}var x=n(2645),j=n(2842),y=n.n(j);function SubscriptionManager(e){let{onSubscriptionChange:t}=e,[n,i]=(0,o.useState)(null),[s,r]=(0,o.useState)(!0),[c,l]=(0,o.useState)(!1),[d,u]=(0,o.useState)(!1);(0,o.useEffect)(()=>{fetchSubscriptionStatus()},[]);let fetchSubscriptionStatus=async()=>{try{let e=await fetch("/api/subscriptions/status",{credentials:"include"});if(e.ok){let t=await e.json();i(t.subscription)}}catch(e){console.error("Error fetching subscription:",e)}finally{r(!1)}},handleCancel=async()=>{if(confirm("Czy na pewno chcesz anulować subskrypcję? Zachowasz wszystkie korzyści do końca obecnego okresu rozliczeniowego.")){u(!0);try{let e=await fetch("/api/subscriptions/cancel",{method:"POST",credentials:"include"});if(e.ok)await e.json(),await fetchSubscriptionStatus(),t&&t();else{let t=await e.json();alert(t.error||"Błąd podczas anulowania subskrypcji")}}catch(e){console.error("Error cancelling subscription:",e),alert("Błąd podczas anulowania subskrypcji")}finally{u(!1)}}};return s?(0,a.jsxs)("div",{className:y().loading,children:[(0,a.jsx)("div",{className:y().spinner}),(0,a.jsx)("p",{children:"Ładowanie informacji o subskrypcji..."})]}):(0,a.jsxs)("div",{className:y().subscriptionManager,children:[(0,a.jsx)("h2",{children:"Subskrypcje"}),(null==n?void 0:n.isActive)?(0,a.jsxs)("div",{className:y().activeSubscription,children:[(0,a.jsxs)("div",{className:y().subscriptionHeader,children:[(0,a.jsxs)("div",{className:y().subscriptionBadge,children:[(0,a.jsx)("span",{className:y().badgeIcon,children:n.isCancelled?"⏰":"✨"}),(0,a.jsx)("span",{children:"PRO"===n.type?"PRO":"PRO+"}),n.isCancelled&&(0,a.jsx)("span",{className:y().cancelledLabel,children:"ANULOWANA"})]}),(0,a.jsxs)("div",{className:y().subscriptionInfo,children:[(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:n.isCancelled?"Subskrypcja anulowana - aktywna do:":"Subskrypcja aktywna do:"})}),(0,a.jsx)("p",{children:n.endDate?new Date(n.endDate).toLocaleDateString("pl-PL"):"Nie określono"}),(0,a.jsxs)("p",{className:y().daysRemaining,children:["Pozostało: ",n.daysRemaining," dni"]}),n.isCancelled&&(0,a.jsx)("p",{className:y().cancelledNote,children:"\uD83D\uDCA1 Możesz wykupić nową subskrypcję, kt\xf3ra zastąpi obecną i zresetuje okres na 30 dni"})]})]}),(0,a.jsxs)("div",{className:y().promotionsCounter,children:[(0,a.jsx)("h3",{children:"Promowanie ogłoszeń"}),(0,a.jsxs)("div",{className:y().counterDisplay,children:[(0,a.jsx)("span",{className:y().counterValue,children:"PRO"===n.type?"Promocje płatne":-1===n.promotionsLimit||0===n.promotionsLimit?"Nielimitowane":"".concat(Math.max(0,n.promotionsLimit-n.promotionsUsed),"/").concat(n.promotionsLimit)}),(0,a.jsx)("span",{className:y().counterLabel,children:"PRO"===n.type?"dostępne za opłatą":-1===n.promotionsLimit||0===n.promotionsLimit?"darmowe promocje":"dostępnych promowań"})]}),"PRO"!==n.type&&n.promotionsLimit>0&&(0,a.jsx)("div",{className:y().promotionProgress,children:(0,a.jsx)("div",{className:y().progressBar,style:{width:"".concat(Math.max(0,(n.promotionsLimit-n.promotionsUsed)/n.promotionsLimit*100),"%")}})})]}),(0,a.jsx)("div",{className:y().subscriptionActions,children:n.isCancelled?(0,a.jsxs)("div",{className:y().renewOptions,children:[(0,a.jsx)("h3",{children:"Kup nową subskrypcję"}),(0,a.jsx)("p",{className:y().renewNote,children:"Nowa subskrypcja zastąpi obecną i zresetuje okres na pełne 30 dni"}),(0,a.jsxs)("div",{className:y().renewButtons,children:[(0,a.jsx)("button",{onClick:()=>window.location.href="/pro",disabled:c,className:"".concat(y().purchaseButton," ").concat(y().proButton),children:"Kup PRO (15 zł)"}),(0,a.jsx)("button",{onClick:()=>window.location.href="/pro",disabled:c,className:"".concat(y().purchaseButton," ").concat(y().proPlusButton),children:"Kup PRO+ (25 zł)"})]})]}):(0,a.jsx)("button",{onClick:handleCancel,disabled:d,className:y().cancelButton,children:d?"Anulowanie...":"Anuluj subskrypcję"})})]}):(0,a.jsxs)("div",{className:y().noSubscription,children:[(0,a.jsx)("p",{children:"Nie masz aktywnej subskrypcji"}),(0,a.jsxs)("div",{className:y().pricingCards,children:[(0,a.jsxs)("div",{className:y().pricingCard,children:[(0,a.jsx)("h3",{children:"Wersja PRO"}),(0,a.jsxs)("div",{className:y().price,children:[(0,a.jsx)("span",{className:y().priceAmount,children:"15"}),(0,a.jsx)("span",{className:y().priceCurrency,children:"zł"}),(0,a.jsx)("span",{className:y().pricePeriod,children:"/miesiąc"})]}),(0,a.jsx)("ul",{className:y().featureList,children:x.p_.PRO.features.map((e,t)=>(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:y().checkmark,children:"✓"}),e]},t))}),(0,a.jsx)("button",{onClick:()=>window.location.href="/pro",disabled:c,className:y().purchaseButton,children:"Kup PRO"})]}),(0,a.jsxs)("div",{className:y().pricingCard,children:[(0,a.jsx)("h3",{children:"Wersja PRO+"}),(0,a.jsxs)("div",{className:y().price,children:[(0,a.jsx)("span",{className:y().priceAmount,children:"25"}),(0,a.jsx)("span",{className:y().priceCurrency,children:"zł"}),(0,a.jsx)("span",{className:y().pricePeriod,children:"/miesiąc"})]}),(0,a.jsx)("ul",{className:y().featureList,children:x.p_.PRO_PLUS.features.map((e,t)=>(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:y().checkmark,children:"✓"}),e]},t))}),(0,a.jsx)("button",{onClick:()=>window.location.href="/pro",disabled:c,className:y().purchaseButton,children:"Kup PRO+"})]})]})]})]})}function ShopifyPromoButton4(e){let{offerId:t}=e,n="shopify-promo-4-".concat(t);return(0,o.useEffect)(()=>{let ShopifyBuyInit=()=>{let e=window.ShopifyBuy.buildClient({domain:"3cusn0-tb.myshopify.com",storefrontAccessToken:"1c310fecfc50cafd83aa554bc311b949"});window.ShopifyBuy.UI.onReady(e).then(e=>{let t=document.getElementById(n);t&&e.createComponent("product",{id:"9716825588054",node:t,moneyFormat:"%7B%7Bamount_with_comma_separator%7D%7D%20z%C5%82",options:{product:{styles:{product:{"@media (min-width: 601px)":{"max-width":"200px","margin-left":"0","margin-bottom":"10px"}},button:{"font-weight":"bold","font-size":"12px","padding-top":"8px","padding-bottom":"8px",":hover":{"background-color":"#0d8e48"},"background-color":"#0e9e50",":focus":{"background-color":"#0d8e48"},"border-radius":"8px","padding-left":"10px","padding-right":"10px"}},buttonDestination:"checkout",contents:{img:!1,title:!1,price:!1},text:{button:"\uD83D\uDE80 Promuj za 4zł"}}}})})};window.ShopifyBuy&&window.ShopifyBuy.UI?ShopifyBuyInit():(()=>{if(document.getElementById("shopify-sdk")){ShopifyBuyInit();return}let e=document.createElement("script");e.id="shopify-sdk",e.async=!0,e.src="https://sdks.shopifycdn.com/buy-button/latest/buy-button-storefront.min.js",document.head.appendChild(e),e.onload=ShopifyBuyInit})()},[n]),(0,a.jsx)("div",{id:n})}function ShopifyPromoButton10(e){let{offerId:t}=e,n="shopify-promo-10-".concat(t);return(0,o.useEffect)(()=>{let ShopifyBuyInit=()=>{let e=window.ShopifyBuy.buildClient({domain:"3cusn0-tb.myshopify.com",storefrontAccessToken:"1c310fecfc50cafd83aa554bc311b949"});window.ShopifyBuy.UI.onReady(e).then(e=>{let t=document.getElementById(n);t&&e.createComponent("product",{id:"9716825817430",node:t,moneyFormat:"%7B%7Bamount_with_comma_separator%7D%7D%20z%C5%82",options:{product:{styles:{product:{"@media (min-width: 601px)":{"max-width":"200px","margin-left":"0","margin-bottom":"10px"}},button:{"font-weight":"bold","font-size":"12px","padding-top":"8px","padding-bottom":"8px",":hover":{"background-color":"#0d8e48"},"background-color":"#0e9e50",":focus":{"background-color":"#0d8e48"},"border-radius":"8px","padding-left":"10px","padding-right":"10px"}},buttonDestination:"checkout",contents:{img:!1,title:!1,price:!1},text:{button:"\uD83D\uDE80 Promuj za 10.99zł"}}}})})};window.ShopifyBuy&&window.ShopifyBuy.UI?ShopifyBuyInit():(()=>{if(document.getElementById("shopify-sdk")){ShopifyBuyInit();return}let e=document.createElement("script");e.id="shopify-sdk",e.async=!0,e.src="https://sdks.shopifycdn.com/buy-button/latest/buy-button-storefront.min.js",document.head.appendChild(e),e.onload=ShopifyBuyInit})()},[n]),(0,a.jsx)("div",{id:n})}function ShopifyPromoButton15(e){let{offerId:t}=e,n="shopify-promo-15-".concat(t);return(0,o.useEffect)(()=>{let ShopifyBuyInit=()=>{let e=window.ShopifyBuy.buildClient({domain:"3cusn0-tb.myshopify.com",storefrontAccessToken:"1c310fecfc50cafd83aa554bc311b949"});window.ShopifyBuy.UI.onReady(e).then(e=>{let t=document.getElementById(n);t&&e.createComponent("product",{id:"9716874903894",node:t,moneyFormat:"%7B%7Bamount_with_comma_separator%7D%7D%20z%C5%82",options:{product:{styles:{product:{"@media (min-width: 601px)":{"max-width":"200px","margin-left":"0","margin-bottom":"10px"}},button:{"font-weight":"bold","font-size":"12px","padding-top":"8px","padding-bottom":"8px",":hover":{"background-color":"#0d8e48"},"background-color":"#0e9e50",":focus":{"background-color":"#0d8e48"},"border-radius":"8px","padding-left":"10px","padding-right":"10px"}},buttonDestination:"checkout",contents:{img:!1,title:!1,price:!1},text:{button:"\uD83D\uDE80 Promuj za 15zł"}}}})})};window.ShopifyBuy&&window.ShopifyBuy.UI?ShopifyBuyInit():(()=>{if(document.getElementById("shopify-sdk")){ShopifyBuyInit();return}let e=document.createElement("script");e.id="shopify-sdk",e.async=!0,e.src="https://sdks.shopifycdn.com/buy-button/latest/buy-button-storefront.min.js",document.head.appendChild(e),e.onload=ShopifyBuyInit})()},[n]),(0,a.jsx)("div",{id:n})}function SmartShopifyPromoButton(e){let{offer:t,onPromotionStart:n}=e,[i,s]=(0,o.useState)(null),[r,c]=(0,o.useState)(!0);(0,o.useEffect)(()=>{fetch("/api/auth/me").then(e=>e.json()).then(e=>{e.user&&s(e.user),c(!1)}).catch(console.error)},[]);let canPromoteForFree=()=>!!i&&("PRO_PLUS"===i.subscriptionType||"PRO"===i.subscriptionType&&!!i.promotionsRemaining&&i.promotionsRemaining>0),handleFreePromotion=async()=>{if(canPromoteForFree()){null==n||n();try{let e=await fetch("/api/offers/promote",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({offerId:t.id.toString()})});if(e.ok)alert("Ogłoszenie zostało promowane za darmo! \uD83C\uDF89"),window.location.reload();else{let t=await e.json();alert(t.error||"Błąd podczas promowania ogłoszenia")}}catch(e){console.error("Error promoting offer:",e),alert("Błąd podczas promowania ogłoszenia")}}};if(r)return(0,a.jsx)("div",{style:{padding:"8px 16px",background:"#f0f0f0",borderRadius:"8px",fontSize:"12px",textAlign:"center"},children:"Ładowanie..."});if(canPromoteForFree())return(0,a.jsxs)("button",{onClick:handleFreePromotion,style:{background:"#ff6b35",color:"white",border:"none",padding:"8px 16px",borderRadius:"8px",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s"},onMouseOver:e=>{e.currentTarget.style.background="#e55a2b"},onMouseOut:e=>{e.currentTarget.style.background="#ff6b35"},children:["\uD83D\uDE80 Promuj za DARMO",(null==i?void 0:i.subscriptionType)==="PRO"&&i.promotionsRemaining&&" (".concat(i.promotionsRemaining," pozostało)")]});let l=(null==t?void 0:t.price)||0;return l>=0&&l<=100?(0,a.jsx)(ShopifyPromoButton4,{offerId:t.id}):l>=101&&l<=200?(0,a.jsx)(ShopifyPromoButton10,{offerId:t.id}):l>=201&&l<=1e3?(0,a.jsx)(ShopifyPromoButton15,{offerId:t.id}):(0,a.jsx)("div",{style:{padding:"8px 16px",background:"#f0f0f0",borderRadius:"8px",fontSize:"12px",color:"#666",textAlign:"center"},children:"Brak promocji dla tej ceny"})}var w=n(3e3),b=n.n(w);function PromotionPaymentModal(e){let{isOpen:t,onClose:n,offer:i,onConfirm:s}=e,[r,c]=(0,o.useState)(!1),[l,d]=(0,o.useState)(0);(0,o.useEffect)(()=>{if(i){let e=(0,x.XM)(i.price,!0);d(e.promoPrice)}},[i]);let handleConfirm=async()=>{c(!0);try{await s(i.id),n()}catch(e){console.error("Error promoting offer:",e)}finally{c(!1)}};return t&&i?(0,a.jsx)("div",{className:b().modalOverlay,onClick:n,children:(0,a.jsxs)("div",{className:b().modalContent,onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:b().modalHeader,children:[(0,a.jsx)("h3",{children:"Promowanie ogłoszenia"}),(0,a.jsx)("button",{className:b().closeBtn,onClick:n,children:"\xd7"})]}),(0,a.jsxs)("div",{className:b().modalBody,children:[(0,a.jsxs)("div",{className:b().offerInfo,children:[(0,a.jsx)("h4",{children:"Ogłoszenie do promowania:"}),(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:i.title})}),(0,a.jsxs)("p",{children:["Cena: ",(0,a.jsxs)("strong",{children:[i.price.toFixed(2)," zł"]})]})]}),(0,a.jsxs)("div",{className:b().promotionDetails,children:[(0,a.jsx)("h4",{children:"Szczeg\xf3ły promocji:"}),(0,a.jsxs)("ul",{children:[(0,a.jsx)("li",{children:"✨ Twoje ogłoszenie zostanie wyświetlone na szczycie listy"}),(0,a.jsx)("li",{children:"⏰ Promocja trwa przez 7 dni"}),(0,a.jsx)("li",{children:"\uD83D\uDC41️ Większa widoczność i więcej kontakt\xf3w"}),(0,a.jsx)("li",{children:"\uD83C\uDFAF Wyr\xf3żnione tło i oznaczenia"})]})]}),(0,a.jsxs)("div",{className:b().pricingSummary,children:[(0,a.jsxs)("div",{className:b().priceRow,children:[(0,a.jsx)("span",{children:"Koszt promocji:"}),(0,a.jsxs)("span",{className:b().price,children:[l.toFixed(2)," zł"]})]}),(0,a.jsxs)("div",{className:b().totalRow,children:[(0,a.jsx)("span",{children:"Razem do zapłaty:"}),(0,a.jsxs)("span",{className:b().totalPrice,children:[l.toFixed(2)," zł"]})]})]}),(0,a.jsxs)("div",{className:b().paymentInfo,children:[(0,a.jsx)("p",{children:"\uD83D\uDCB3 Płatność zostanie przetworzona natychmiastowo"}),(0,a.jsx)("p",{children:"\uD83D\uDCE7 Otrzymasz potwierdzenie na email"})]})]}),(0,a.jsxs)("div",{className:b().modalFooter,children:[(0,a.jsx)("button",{className:b().cancelBtn,onClick:n,disabled:r,children:"Anuluj"}),(0,a.jsx)("button",{className:b().confirmBtn,onClick:handleConfirm,disabled:r,children:r?"Przetwarzanie...":"Zapłać ".concat(l.toFixed(2)," zł")})]})]})}):null}function Profile(){var e;let t=(0,i.useRouter)(),[n,r]=(0,o.useState)([]),[l,d]=(0,o.useState)([]),[u,m]=(0,o.useState)(null),[h,f]=(0,o.useState)(null),[_,g]=(0,o.useState)(null),[x,j]=(0,o.useState)("natura"),[y,w]=(0,o.useState)("offers"),[b,v]=(0,o.useState)(null),[S,z]=(0,o.useState)(null),[N,P]=(0,o.useState)(!1),[C,k]=(0,o.useState)(null);(0,o.useEffect)(()=>{fetch("/api/auth/me").then(e=>e.json()).then(e=>m(e.user))},[]),(0,o.useEffect)(()=>{if(t.query.tab&&w(t.query.tab),t.query.chatId){let e=parseInt(t.query.chatId);if(f(e),t.query.offerId)g(t.query.offerId);else try{let t=JSON.parse(localStorage.getItem("chatOfferMap")||"{}"),n=t[e];n&&(console.log("\uD83D\uDCC2 Found offer mapping in localStorage:",{chatId:e,offerId:n}),g(n.toString()))}catch(e){console.error("⚠️ Failed to read chat-offer mapping:",e)}}t.query.offerId&&!t.query.chatId&&g(t.query.offerId)},[t.query]),(0,o.useEffect)(()=>{if(!u)return;let e="admin@admin.com"===u.email||u.isAdmin;e?fetch("/api/offers").then(e=>e.json()).then(e=>{r(e.offers||[])}).catch(console.error):fetch("/api/auth/my-offers").then(e=>e.json()).then(e=>{r(e.offers||[])}).catch(console.error)},[u]),(0,o.useEffect)(()=>{u&&fetch("/api/auth/favorites").then(e=>e.json()).then(d).catch(console.error)},[u]),(0,o.useEffect)(()=>{let e=new MutationObserver(()=>{let e=document.documentElement.getAttribute("data-theme")||"natura";j(e)});e.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]});let t=document.documentElement.getAttribute("data-theme")||"natura";return j(t),()=>e.disconnect()},[]);let del=async e=>{if(confirm("Usunąć to ogłoszenie?"))try{let t=await fetch("/api/offers/".concat(e),{method:"DELETE",credentials:"include"});if(t.ok)r(n.filter(t=>t.id!==e)),alert("Ogłoszenie zostało usunięte!");else{let e=await t.json();alert("Błąd: ".concat(e.error||"Nie udało się usunąć ogłoszenia"))}}catch(e){console.error("Error deleting offer:",e),alert("Wystąpił błąd podczas usuwania ogłoszenia")}},removeFavorite=async e=>{if(confirm("Usunąć z ulubionych?"))try{let t=await fetch("/api/auth/favorites",{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({offerId:e})});t.ok?d(l.filter(t=>t.id!==e)):alert("Błąd podczas usuwania z ulubionych")}catch(e){console.error("Error removing from favorites:",e),alert("Błąd podczas usuwania z ulubionych")}},openOfferDetails=async e=>{t.push("/?offerId=".concat(e.id))},promoteOffer=async e=>{let t=e.toString();z(t);try{let e=await fetch("/api/offers/promote",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({offerId:t})});if(e.ok){let t=await e.json();if((null==u?void 0:u.hasPro)?-1===t.promotionsRemaining?alert("Ogłoszenie zostało promowane! (PRO+ - nieograniczone promocje)"):alert("Ogłoszenie zostało promowane! Pozostało promowań: ".concat(t.promotionsRemaining)):alert("Płatność została przetworzona! Ogłoszenie zostało promowane na 7 dni."),u){let e="admin@admin.com"===u.email||u.isAdmin;e?fetch("/api/offers").then(e=>e.json()).then(e=>{r(e.offers||[])}):fetch("/api/auth/my-offers").then(e=>e.json()).then(e=>{r(e.offers||[])})}}else{let t=await e.json();alert(t.error||"Błąd podczas promowania ogłoszenia")}}catch(e){console.error("Error promoting offer:",e),alert("Błąd podczas promowania ogłoszenia")}finally{z(null)}},handleChatDeleted=e=>{h===e&&(f(null),g(null));try{let t=JSON.parse(localStorage.getItem("chatOfferMap")||"{}");delete t[e],localStorage.setItem("chatOfferMap",JSON.stringify(t)),console.log("\uD83D\uDDD1️ Removed chat-offer mapping for chat:",e)}catch(e){console.error("⚠️ Failed to clean chat-offer mapping:",e)}};return(0,a.jsxs)("div",{className:c().page,children:[(0,a.jsx)(s.Z,{}),(0,a.jsxs)("main",{className:c().main,children:[(0,a.jsxs)("div",{className:c().bgContainer,children:[(()=>{switch(x){case"light":return(0,a.jsx)("video",{className:c().bgVideo,src:"/chmury.mp4",autoPlay:!0,loop:!0,muted:!0,playsInline:!0});case"dark":default:return(0,a.jsx)("video",{className:c().bgVideo,src:"/smoke.mp4",autoPlay:!0,loop:!0,muted:!0,playsInline:!0});case"night":return(0,a.jsx)("div",{className:c().nightBackground});case"natura":return(0,a.jsx)("div",{className:c().naturaBackground})}})(),(0,a.jsx)("div",{className:c().bgTint})]}),(0,a.jsx)("div",{className:c().content,children:(0,a.jsxs)("div",{className:c().profileLayout,children:[(0,a.jsxs)("div",{className:c().sidebar,children:[(0,a.jsxs)("div",{className:c().userInfo,children:[(0,a.jsx)("div",{className:c().userAvatar,children:(null==u?void 0:null===(e=u.email)||void 0===e?void 0:e.charAt(0).toUpperCase())||"U"}),(0,a.jsxs)("div",{className:c().userDetails,children:[(0,a.jsx)("h2",{children:"M\xf3j profil"}),(0,a.jsx)("p",{children:null==u?void 0:u.email}),(null==u?void 0:u.isAdmin)&&(0,a.jsx)("span",{className:c().adminBadge,children:"Admin"})]})]}),(0,a.jsxs)("nav",{className:c().navigation,children:[(0,a.jsxs)("button",{className:"".concat(c().navButton," ").concat("offers"===y?c().active:""),onClick:()=>w("offers"),children:[(0,a.jsx)("span",{className:c().navIcon,children:"\uD83D\uDCCB"}),"Moje ogłoszenia",(0,a.jsx)("span",{className:c().navCount,children:n.length})]}),(0,a.jsxs)("button",{className:"".concat(c().navButton," ").concat("favorites"===y?c().active:""),onClick:()=>w("favorites"),children:[(0,a.jsx)("span",{className:c().navIcon,children:"❤️"}),"Ulubione",(0,a.jsx)("span",{className:c().navCount,children:l.length})]}),(0,a.jsxs)("button",{className:"".concat(c().navButton," ").concat("chat"===y?c().active:""),onClick:()=>w("chat"),children:[(0,a.jsx)("span",{className:c().navIcon,children:"\uD83D\uDCAC"}),"Chat"]}),(0,a.jsxs)("button",{className:"".concat(c().navButton," ").concat("settings"===y?c().active:""),onClick:()=>w("settings"),children:[(0,a.jsx)("span",{className:c().navIcon,children:"⚙️"}),"Ustawienia"]}),(0,a.jsxs)("button",{className:"".concat(c().navButton," ").concat("ratings"===y?c().active:""),onClick:()=>w("ratings"),children:[(0,a.jsx)("span",{className:c().navIcon,children:"⭐"}),"Moje oceny"]}),(0,a.jsxs)("button",{className:"".concat(c().navButton," ").concat("subscription"===y?c().active:""),onClick:()=>w("subscription"),children:[(0,a.jsx)("span",{className:c().navIcon,children:"\uD83D\uDCC5"}),"Subskrypcje"]})]})]}),(0,a.jsx)("div",{className:c().mainContent,children:(()=>{switch(y){case"offers":return(0,a.jsx)("div",{className:c().offersGrid,children:0===n.length?(0,a.jsxs)("div",{className:c().emptyState,children:[(0,a.jsx)("h3",{children:"Brak ogłoszeń"}),(0,a.jsx)("p",{children:"Nie masz jeszcze żadnych ogłoszeń."}),(0,a.jsx)("a",{href:"/add-new",className:c().addButton,children:"Dodaj pierwsze ogłoszenie"})]}):n.map(e=>(0,a.jsxs)("div",{className:c().offerCard,children:[(0,a.jsxs)("div",{className:c().offerContent,onClick:()=>openOfferDetails(e),children:[(0,a.jsxs)("div",{className:c().offerHeader,children:[(0,a.jsx)("h3",{children:e.title}),(0,a.jsxs)("span",{className:c().offerPrice,children:[e.price," zł"]})]}),(0,a.jsx)("p",{className:c().offerDescription,children:e.description}),(0,a.jsxs)("div",{className:c().offerFooter,children:[(0,a.jsx)("span",{className:c().offerCategory,children:e.category}),(0,a.jsx)("span",{className:c().offerLocation,children:e.location})]})]}),(0,a.jsxs)("div",{className:c().offerActions,children:[(0,a.jsx)("button",{onClick:n=>{n.stopPropagation(),t.push("/edit/".concat(e.id))},className:c().editBtn,style:{width:"100%",fontSize:"0.9rem",padding:"0.8rem 1.2rem"},children:"Edytuj ogłoszenie"}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),del(e.id)},className:c().deleteBtn,style:{width:"100%",fontSize:"0.9rem",padding:"0.8rem 1.2rem"},children:"Usuń ogłoszenie"}),(0,a.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,a.jsx)(SmartShopifyPromoButton,{offer:{id:e.id,price:e.price||0,title:e.title},onPromotionStart:()=>{z(e.id.toString()),console.log("Rozpoczynam promocję ogłoszenia: ".concat(e.title))}})})]})]},e.id))});case"favorites":return(0,a.jsx)("div",{className:c().offersGrid,children:0===l.length?(0,a.jsxs)("div",{className:c().emptyState,children:[(0,a.jsx)("h3",{children:"Brak ulubionych ogłoszeń"}),(0,a.jsx)("p",{children:"Nie masz jeszcze żadnych ulubionych ogłoszeń."}),(0,a.jsx)("a",{href:"/",className:c().addButton,children:"Przeglądaj ogłoszenia"})]}):l.map(e=>(0,a.jsxs)("div",{className:c().offerCard,children:[(0,a.jsxs)("div",{className:c().offerContent,onClick:()=>openOfferDetails(e),children:[(0,a.jsxs)("div",{className:c().offerHeader,children:[(0,a.jsx)("h3",{children:e.title}),(0,a.jsxs)("span",{className:c().offerPrice,children:[e.price," zł"]})]}),(0,a.jsx)("p",{className:c().offerDescription,children:e.description}),(0,a.jsxs)("div",{className:c().offerFooter,children:[(0,a.jsx)("span",{className:c().offerCategory,children:e.category}),(0,a.jsx)("span",{className:c().offerLocation,children:e.location})]})]}),(0,a.jsx)("div",{className:c().offerActions,style:{gridTemplateColumns:"1fr"},children:(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),removeFavorite(e.id)},className:c().deleteBtn,style:{width:"100%",fontSize:"0.9rem",padding:"0.8rem 1.2rem"},children:"Usuń z ulubionych"})})]},e.id))});case"chat":return(0,a.jsx)("div",{className:c().tabContent,children:(0,a.jsxs)("div",{style:{display:"flex",height:"650px",width:"90%",margin:"0 auto",borderRadius:"12px",overflow:"hidden",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)",border:"1px solid rgba(255, 255, 255, 0.2)"},children:[(0,a.jsx)("div",{style:{width:"300px",borderRight:"1px solid rgba(0, 0, 0, 0.1)",background:"rgba(255, 255, 255, 0.8)",overflowY:"auto"},children:(0,a.jsx)(ChatList,{onSelect:f,onChatDeleted:handleChatDeleted})}),(0,a.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",background:"#f8f9fa"},children:h?(0,a.jsx)(ChatWindow,{chatId:h,offerId:_,onChatDeleted:handleChatDeleted}):(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",color:"#6c757d",textAlign:"center",padding:"2rem"},children:[(0,a.jsx)("div",{style:{fontSize:"4rem",marginBottom:"1rem",opacity:.5},children:"\uD83D\uDCAC"}),(0,a.jsx)("h3",{style:{margin:"0 0 0.5rem 0",color:"#000000",fontSize:"1.5rem"},children:"Wybierz rozmowę"}),(0,a.jsx)("p",{style:{margin:0,fontSize:"1rem",color:"#333333"},children:"Kliknij na rozmowę z lewej strony, aby rozpocząć pisanie wiadomości"})]})})]})});case"settings":return(0,a.jsx)("div",{className:c().tabContent,children:(0,a.jsx)(AccountSettings,{user:u})});case"ratings":return(0,a.jsx)("div",{className:c().tabContent,children:u?(0,a.jsx)(UserRatings,{userEmail:u.email}):(0,a.jsxs)("div",{className:c().emptyState,children:[(0,a.jsx)("h3",{children:"Ładowanie..."}),(0,a.jsx)("p",{children:"Proszę czekać..."})]})});case"subscription":return(0,a.jsx)("div",{className:c().tabContent,children:(0,a.jsx)(SubscriptionManager,{onSubscriptionChange:()=>{fetch("/api/auth/me").then(e=>e.json()).then(e=>m(e.user))}})});default:return null}})()})]})}),(0,a.jsx)(p.Z,{offer:b,isOpen:!!b,onClose:()=>{v(null)}}),(0,a.jsx)(PromotionPaymentModal,{isOpen:N,onClose:()=>{P(!1),k(null)},offer:C?{id:C.id,title:C.title,price:C.price}:{id:"",title:"",price:0},onConfirm:promoteOffer})]})]})}},1228:function(e){e.exports={settingsContainer:"AccountSettings_settingsContainer__4V2Zc",settingsHeader:"AccountSettings_settingsHeader___yeJ7",message:"AccountSettings_message__eRZ1M",success:"AccountSettings_success__sZz3I",error:"AccountSettings_error__LjLKr",settingsContent:"AccountSettings_settingsContent__UE99X",settingsNav:"AccountSettings_settingsNav__yphiQ",navButton:"AccountSettings_navButton__5VHDE",active:"AccountSettings_active__h7cif",settingsPanel:"AccountSettings_settingsPanel__2TiQu",section:"AccountSettings_section__CLxXI",form:"AccountSettings_form__cvTGU",formGroup:"AccountSettings_formGroup__3kgCb",select:"AccountSettings_select__c5UQv",primaryButton:"AccountSettings_primaryButton__aDwe1",secondaryButton:"AccountSettings_secondaryButton__K4Gbw",dangerButton:"AccountSettings_dangerButton__Pqx5M",divider:"AccountSettings_divider__NDKK1",preferenceGroup:"AccountSettings_preferenceGroup__jANTK",themeSelector:"AccountSettings_themeSelector__zSO_3",themeOption:"AccountSettings_themeOption__9TzoO",themeCard:"AccountSettings_themeCard__yCb9_",themeLabel:"AccountSettings_themeLabel__ixV7o",themeDesc:"AccountSettings_themeDesc__KSz0s",notificationGroup:"AccountSettings_notificationGroup__U2l9M",switchLabel:"AccountSettings_switchLabel__I9xcw",switch:"AccountSettings_switch__VzcqN",switchTitle:"AccountSettings_switchTitle__dqeRz",switchDesc:"AccountSettings_switchDesc__BYYhv",accountInfo:"AccountSettings_accountInfo__5af3P",infoItem:"AccountSettings_infoItem__oBWUo",infoValue:"AccountSettings_infoValue__9kVGg",adminBadge:"AccountSettings_adminBadge__R5y5W",userBadge:"AccountSettings_userBadge__ljQgf",dangerZone:"AccountSettings_dangerZone__0TJyq",dataManagement:"AccountSettings_dataManagement__zG_5d",dataItem:"AccountSettings_dataItem__ERPFq",fileInputLabel:"AccountSettings_fileInputLabel__GBlzo",fileInput:"AccountSettings_fileInput__hscXp",statsGrid:"AccountSettings_statsGrid__JptB4",statCard:"AccountSettings_statCard__D_Y1b",statIcon:"AccountSettings_statIcon__TLFMb",statValue:"AccountSettings_statValue__Dlzzc",statLabel:"AccountSettings_statLabel__Azks2",subscriptionActive:"AccountSettings_subscriptionActive__40UVg",subscriptionCard:"AccountSettings_subscriptionCard__yJ8Ec",subscriptionHeader:"AccountSettings_subscriptionHeader__1xBrh",subscriptionIcon:"AccountSettings_subscriptionIcon__OccHz",subscriptionInfo:"AccountSettings_subscriptionInfo__dtWYo",subscriptionStatus:"AccountSettings_subscriptionStatus__pqPti",activeBadge:"AccountSettings_activeBadge__V3tx6",subscriptionDetails:"AccountSettings_subscriptionDetails__BNZep",detailItem:"AccountSettings_detailItem__RtNk7",detailLabel:"AccountSettings_detailLabel__GimeT",detailValue:"AccountSettings_detailValue__MoHkG",warning:"AccountSettings_warning__5QJSF",subscriptionFeatures:"AccountSettings_subscriptionFeatures__sW_Dk",featuresList:"AccountSettings_featuresList__5HfUg",featureItem:"AccountSettings_featureItem__Lls9j",featureIcon:"AccountSettings_featureIcon__mLSAN",subscriptionActions:"AccountSettings_subscriptionActions__MRAkx",upgradeButton:"AccountSettings_upgradeButton__Tbspf",subscribeButton:"AccountSettings_subscribeButton__KB9wf",subscribeButtonPrimary:"AccountSettings_subscribeButtonPrimary__BDXH8",subscriptionInactive:"AccountSettings_subscriptionInactive__kHKhV",noSubscriptionCard:"AccountSettings_noSubscriptionCard__ePUUD",noSubscriptionIcon:"AccountSettings_noSubscriptionIcon__UUYle",proPlans:"AccountSettings_proPlans__uXd3y",planCard:"AccountSettings_planCard__y3zQ2",recommended:"AccountSettings_recommended__3GIJF",recommendedBadge:"AccountSettings_recommendedBadge__PLYCj",planPrice:"AccountSettings_planPrice__BUzAv",planFeatures:"AccountSettings_planFeatures__dQ4gz"}},1285:function(e){e.exports={list:"ChatList_list__dBWjk",chatItem:"ChatList_chatItem__zh9Xo",selected:"ChatList_selected__nIXxg",avatar:"ChatList_avatar__5nDaV",chatInfo:"ChatList_chatInfo__507Ha",userName:"ChatList_userName__uAbRR",lastMessage:"ChatList_lastMessage__2H_g2",timestamp:"ChatList_timestamp__9Z0IY",chatActions:"ChatList_chatActions__h2uMg",deleteButton:"ChatList_deleteButton__KbdrW",emptyState:"ChatList_emptyState__W8Zdr",icon:"ChatList_icon__AT0yL"}},2457:function(e){e.exports={window:"ChatWindow_window__sCqAH",header:"ChatWindow_header__kVaYr",avatar:"ChatWindow_avatar__69Y_I",userInfo:"ChatWindow_userInfo__ov9kP",messages:"ChatWindow_messages__x6d5_",message:"ChatWindow_message__Fg4Wk",me:"ChatWindow_me__AtWm_",them:"ChatWindow_them__yS7rC",inputRow:"ChatWindow_inputRow__IEwbd",timestamp:"ChatWindow_timestamp__FKupd",emptyState:"ChatWindow_emptyState__BCZz7",icon:"ChatWindow_icon__X6Q1l",headerActions:"ChatWindow_headerActions__Zzt8K",offerButton:"ChatWindow_offerButton__zPmxc",deleteButton:"ChatWindow_deleteButton__ejpmS",attachButton:"ChatWindow_attachButton__qhJ5g",filePreview:"ChatWindow_filePreview__q8w7D",sendButton:"ChatWindow_sendButton__fcCRn",messageImage:"ChatWindow_messageImage__H046m"}},3e3:function(e){e.exports={modalOverlay:"PromotionPaymentModal_modalOverlay__JvWdS",modalContent:"PromotionPaymentModal_modalContent__j5tbL",modalHeader:"PromotionPaymentModal_modalHeader__5m7Bw",closeBtn:"PromotionPaymentModal_closeBtn__3hd6W",modalBody:"PromotionPaymentModal_modalBody___ZUcU",offerInfo:"PromotionPaymentModal_offerInfo__D3Yly",promotionDetails:"PromotionPaymentModal_promotionDetails__c8Yqz",pricingSummary:"PromotionPaymentModal_pricingSummary__m3xlq",priceRow:"PromotionPaymentModal_priceRow__T_JDj",price:"PromotionPaymentModal_price__0zTtV",totalRow:"PromotionPaymentModal_totalRow__CDBQW",totalPrice:"PromotionPaymentModal_totalPrice__8Vigc",paymentInfo:"PromotionPaymentModal_paymentInfo__1ya2U",modalFooter:"PromotionPaymentModal_modalFooter__4jdvA",cancelBtn:"PromotionPaymentModal_cancelBtn__H529g",confirmBtn:"PromotionPaymentModal_confirmBtn__IE37i"}},2842:function(e){e.exports={subscriptionManager:"SubscriptionManager_subscriptionManager__zvjU5",loading:"SubscriptionManager_loading__2M7nO",spinner:"SubscriptionManager_spinner__mwLKb",spin:"SubscriptionManager_spin__ewztj",activeSubscription:"SubscriptionManager_activeSubscription__0obmq",subscriptionHeader:"SubscriptionManager_subscriptionHeader__zrsGw",subscriptionBadge:"SubscriptionManager_subscriptionBadge__pvMO7",badgeIcon:"SubscriptionManager_badgeIcon__byoXo",subscriptionInfo:"SubscriptionManager_subscriptionInfo__8IJQ7",daysRemaining:"SubscriptionManager_daysRemaining__vikk_",promotionsCounter:"SubscriptionManager_promotionsCounter__BbPrG",counterDisplay:"SubscriptionManager_counterDisplay__CdeE0",counterValue:"SubscriptionManager_counterValue__1lrWs",counterLabel:"SubscriptionManager_counterLabel__RDbHs",promotionProgress:"SubscriptionManager_promotionProgress__9IVHZ",progressBar:"SubscriptionManager_progressBar__NG7_4",subscriptionActions:"SubscriptionManager_subscriptionActions__VtRwP",cancelButton:"SubscriptionManager_cancelButton__20lUv",noSubscription:"SubscriptionManager_noSubscription__QYhM7",pricingCards:"SubscriptionManager_pricingCards__G6KPx",pricingCard:"SubscriptionManager_pricingCard__qrAn5",price:"SubscriptionManager_price__xC_6k",priceAmount:"SubscriptionManager_priceAmount__mR5wm",priceCurrency:"SubscriptionManager_priceCurrency__zsEEi",pricePeriod:"SubscriptionManager_pricePeriod__t2IQf",featureList:"SubscriptionManager_featureList__f9Iq9",checkmark:"SubscriptionManager_checkmark__YA96q",purchaseButton:"SubscriptionManager_purchaseButton__Xoclv",countUp:"SubscriptionManager_countUp__Dr7q8",cancelledLabel:"SubscriptionManager_cancelledLabel__uQLDi",cancelledNote:"SubscriptionManager_cancelledNote__s3qnH",renewOptions:"SubscriptionManager_renewOptions__K7bGR",renewNote:"SubscriptionManager_renewNote__DOzA3",renewButtons:"SubscriptionManager_renewButtons__RJPcP",proButton:"SubscriptionManager_proButton__0lBmC",proPlusButton:"SubscriptionManager_proPlusButton__pgKA3"}},8940:function(e){e.exports={ratingsContainer:"UserRatings_ratingsContainer__kKmfV",ratingsHeader:"UserRatings_ratingsHeader__8G9Rd",averageRating:"UserRatings_averageRating__9DAKu",averageStars:"UserRatings_averageStars__royk_",averageText:"UserRatings_averageText__jhiuK",noRatings:"UserRatings_noRatings__hxzXo",loadingSpinner:"UserRatings_loadingSpinner__uz2rZ",ratingsList:"UserRatings_ratingsList__VQNmG",ratingItem:"UserRatings_ratingItem__eTi3l",ratingHeader:"UserRatings_ratingHeader__OG6Nw",ratingStars:"UserRatings_ratingStars__I3LkN",star:"UserRatings_star__buURx",filled:"UserRatings_filled__9s1Ou",ratingDate:"UserRatings_ratingDate__kDi3m",ratingComment:"UserRatings_ratingComment__WLhpL",ratingMeta:"UserRatings_ratingMeta___skt4",reviewer:"UserRatings_reviewer__afoYs",offerTitle:"UserRatings_offerTitle__ujKHK",fadeIn:"UserRatings_fadeIn__MCsgF"}},5003:function(e){e.exports={page:"Profile_page__oGOTm",main:"Profile_main__4qj_H",bgContainer:"Profile_bgContainer__7QmRr",bgVideo:"Profile_bgVideo__aLibK",naturaBackground:"Profile_naturaBackground__aev71",naturaZoom:"Profile_naturaZoom__ob5DH",bgTint:"Profile_bgTint__7N1BY",profileLayout:"Profile_profileLayout__fZFqd",sidebar:"Profile_sidebar__o2o7w",userInfo:"Profile_userInfo__St3HB",userAvatar:"Profile_userAvatar__cbkAG",userDetails:"Profile_userDetails__R7pz6",adminBadge:"Profile_adminBadge__oqCcl",navigation:"Profile_navigation__2t1Om",navButton:"Profile_navButton__uB3m9",active:"Profile_active__NLVi_",navIcon:"Profile_navIcon__VWlTC",navCount:"Profile_navCount__2cSS5",mainContent:"Profile_mainContent__8HuB_",tabContent:"Profile_tabContent__EWM1_",offersGrid:"Profile_offersGrid__bZR12",offerCard:"Profile_offerCard__KgpjQ",offerContent:"Profile_offerContent__fhc9q",offerHeader:"Profile_offerHeader__zLQ_Y",offerPrice:"Profile_offerPrice__N7hSa",offerDescription:"Profile_offerDescription__K9Egu",offerFooter:"Profile_offerFooter___fduv",offerCategory:"Profile_offerCategory__pM6XS",offerLocation:"Profile_offerLocation__2PH7D",offerActions:"Profile_offerActions__6SMD9",deleteBtn:"Profile_deleteBtn__8JURW",editBtn:"Profile_editBtn__S9rR1",promoteBtn:"Profile_promoteBtn__xXwzb",emptyState:"Profile_emptyState__aIKpT",addButton:"Profile_addButton__dZq6u",modal:"Profile_modal__z0rDi",modalContent:"Profile_modalContent__rcc2C",modalHeader:"Profile_modalHeader__ASXTu",closeBtn:"Profile_closeBtn__sS5bh",modalBody:"Profile_modalBody__VWl30",offerMeta:"Profile_offerMeta__aiaAQ",category:"Profile_category__LJ4s_",location:"Profile_location__X5fkX",date:"Profile_date__Wu09z",contactInfo:"Profile_contactInfo__6mMFP",offerStats:"Profile_offerStats__P0gxu",statsGrid:"Profile_statsGrid__d4dn5",statItem:"Profile_statItem__c9Mjs",statIcon:"Profile_statIcon__6r5xp",statLabel:"Profile_statLabel__J4GQU",statValue:"Profile_statValue__tsUwL",modalFooter:"Profile_modalFooter__k_AMi"}}},function(e){e.O(0,[424,68,372,343,774,888,179],function(){return e(e.s=6896)}),_N_E=e.O()}]);