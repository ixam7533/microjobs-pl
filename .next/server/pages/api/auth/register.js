"use strict";(()=>{var e={};e.id=7007,e.ids=[7007],e.modules={3524:e=>{e.exports=require("@prisma/client")},7096:e=>{e.exports=require("bcrypt")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6555:e=>{e.exports=import("uuid")},1333:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{config:()=>l,default:()=>d,routeModule:()=>p});var i=a(1802),s=a(7153),n=a(6249),o=a(8806),u=e([o]);o=(u.then?(await u)():u)[0];let d=(0,n.l)(o,"default"),l=(0,n.l)(o,"config"),p=new i.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/auth/register",pathname:"/api/auth/register",bundlePath:"",filename:""},userland:o});r()}catch(e){r(e)}})},8806:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>handler});var i=a(3524),s=a(7096),n=a.n(s),o=a(6555),u=e([o]);o=(u.then?(await u)():u)[0];let d=new i.PrismaClient;async function handler(e,t){if("POST"!==e.method)return t.status(405).end();let{email:a,password:r}=e.body;if(!a||!r)return t.status(400).json({error:"Wypełnij pola e-mail i hasło."});let i=await n().hash(r,10),s=(0,o.v4)(),u=e.headers["x-forwarded-proto"]||"http",l=e.headers.host,p=`${u}://${l}`,c=`${p}/api/auth/confirm?token=${s}`;try{return await d.user.create({data:{email:a,hash:i,confirmed:!1,confirmToken:s}}),t.status(201).json({message:"Zarejestrowano. Kliknij link, aby potwierdzić e-mail:",confirmLink:c})}catch(e){return t.status(400).json({error:"Ten e-mail jest już zarejestrowany."})}}r()}catch(e){r(e)}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[4222],()=>__webpack_exec__(1333));module.exports=a})();