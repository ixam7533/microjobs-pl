(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{577:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return i(486)}])},3130:function(e,n,i){"use strict";i.d(n,{Z:function(){return AdminSubscriptionPanel}});var s=i(5893),a=i(7294),t=i(9989),r=i.n(t);function AdminSubscriptionPanel(e){let{isVisible:n,onClose:i}=e,[t,l]=(0,a.useState)([]),[c,o]=(0,a.useState)(!1),[u,d]=(0,a.useState)(""),[m,p]=(0,a.useState)("PRO"),[h,_]=(0,a.useState)(30),[j,x]=(0,a.useState)("");(0,a.useEffect)(()=>{n&&fetchUsers()},[n]);let fetchUsers=async()=>{o(!0);try{let e=await fetch("/api/admin/users");if(e.ok){let n=await e.json();l(n.users)}}catch(e){console.error("Error fetching users:",e)}o(!1)},handleGrantSubscription=async()=>{if(!u){x("Wybierz użytkownika");return}o(!0);try{let e=await fetch("/api/admin/manage-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userEmail:u,subscriptionType:m,duration:h})}),n=await e.json();e.ok?(x("✅ Pomyślnie nadano ".concat(m," dla ").concat(u)),fetchUsers(),d("")):x("❌ Błąd: ".concat(n.error))}catch(e){x("❌ Błąd podczas nadawania subskrypcji")}o(!1)},getSubscriptionColor=e=>{switch(e){case"PRO":return"#4CAF50";case"PRO_PLUS":return"#FF9800";default:return"#9E9E9E"}},getStatusColor=e=>e?"#4CAF50":"#F44336";return n?(0,s.jsx)("div",{className:r().overlay,children:(0,s.jsxs)("div",{className:r().panel,children:[(0,s.jsxs)("div",{className:r().header,children:[(0,s.jsx)("h2",{children:"\uD83D\uDC51 Panel Administracyjny - Zarządzanie Subskrypcjami"}),(0,s.jsx)("button",{className:r().closeButton,onClick:i,children:"✕"})]}),(0,s.jsxs)("div",{className:r().content,children:[(0,s.jsxs)("div",{className:r().grantSection,children:[(0,s.jsx)("h3",{children:"Nadaj Subskrypcję"}),(0,s.jsxs)("div",{className:r().formGroup,children:[(0,s.jsx)("label",{children:"Wybierz użytkownika:"}),(0,s.jsxs)("select",{value:u,onChange:e=>d(e.target.value),className:r().select,children:[(0,s.jsx)("option",{value:"",children:"-- Wybierz użytkownika --"}),t.map(e=>(0,s.jsxs)("option",{value:e.email,children:[e.email," (",e.name||"Bez nazwy",") - ",e.subscriptionType]},e.id))]})]}),(0,s.jsxs)("div",{className:r().formGroup,children:[(0,s.jsx)("label",{children:"Typ subskrypcji:"}),(0,s.jsxs)("select",{value:m,onChange:e=>p(e.target.value),className:r().select,children:[(0,s.jsx)("option",{value:"FREE",children:"FREE"}),(0,s.jsx)("option",{value:"PRO",children:"PRO"}),(0,s.jsx)("option",{value:"PRO_PLUS",children:"PRO+"})]})]}),(0,s.jsxs)("div",{className:r().formGroup,children:[(0,s.jsx)("label",{children:"Czas trwania (dni):"}),(0,s.jsx)("input",{type:"number",value:h,onChange:e=>_(parseInt(e.target.value)),min:"1",max:"365",className:r().input})]}),(0,s.jsx)("button",{onClick:handleGrantSubscription,disabled:c,className:r().grantButton,children:c?"Przetwarzanie...":"Nadaj Subskrypcję"}),j&&(0,s.jsx)("div",{className:r().message,children:j})]}),(0,s.jsxs)("div",{className:r().usersSection,children:[(0,s.jsxs)("h3",{children:["Lista Użytkownik\xf3w (",t.length,")"]}),(0,s.jsx)("div",{className:r().usersList,children:t.map(e=>(0,s.jsxs)("div",{className:r().userCard,children:[(0,s.jsxs)("div",{className:r().userInfo,children:[(0,s.jsxs)("div",{className:r().userEmail,children:[e.email," ",e.isAdmin&&"\uD83D\uDC51"]}),(0,s.jsx)("div",{className:r().userName,children:e.name||"Bez nazwy"})]}),(0,s.jsxs)("div",{className:r().subscriptionInfo,children:[(0,s.jsx)("span",{className:r().subscriptionType,style:{backgroundColor:getSubscriptionColor(e.subscriptionType)},children:e.subscriptionType}),(0,s.jsx)("span",{className:r().status,style:{color:getStatusColor(e.isSubscriptionActive)},children:e.isSubscriptionActive?"Aktywna":"Nieaktywna"}),null!==e.daysRemaining&&(0,s.jsxs)("span",{className:r().daysRemaining,children:[e.daysRemaining," dni"]})]}),(0,s.jsxs)("div",{className:r().usageInfo,children:[(0,s.jsxs)("small",{children:["Promocje użyte: ",e.promotionsUsed]}),(0,s.jsxs)("small",{children:["Dołączył: ",new Date(e.createdAt).toLocaleDateString("pl-PL")]})]})]},e.id))})]})]})]})}):null}},486:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return AdminPage}});var s=i(5893),a=i(7294),t=i(1163),r=i(3130);function AdminPage(){let[e,n]=(0,a.useState)(null),[i,l]=(0,a.useState)(!0),c=(0,t.useRouter)();return((0,a.useEffect)(()=>{fetch("/api/auth/me").then(async e=>{if(!e.ok)return null;try{return await e.json()}catch(e){return console.error("Invalid JSON from /api/auth/me"),null}}).then(e=>{if(null==e?void 0:e.user){let i=e.user;n(i);let s=i.isAdmin||"microjobsj7@gmail.com"===i.email;if(!s){c.replace("/");return}}else{c.replace("/login");return}l(!1)}).catch(e=>{console.error("Network error on /api/auth/me:",e),c.replace("/login")})},[c]),i)?(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",flexDirection:"column",gap:"20px"},children:[(0,s.jsx)("div",{style:{fontSize:"2rem"},children:"\uD83D\uDC51"}),(0,s.jsx)("div",{children:"Sprawdzam uprawnienia administratora..."})]}):e&&(e.isAdmin||"microjobsj7@gmail.com"===e.email)?(0,s.jsxs)("div",{style:{padding:"20px"},children:[(0,s.jsx)("h1",{style:{textAlign:"center",marginBottom:"30px"},children:"\uD83D\uDC51 Panel Administracyjny MicroJobs"}),(0,s.jsxs)("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"10px",marginBottom:"20px",border:"2px solid #e9ecef"},children:[(0,s.jsx)("h2",{children:"Witaj, Administrator!"}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Email:"})," ",e.email]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Status:"})," ",e.isAdmin?"Administrator":"Admin (specjalny dostęp)"]}),(0,s.jsx)("p",{children:"Z tego panelu możesz zarządzać subskrypcjami użytkownik\xf3w, nadawać uprawnienia PRO i PRO+, oraz monitorować aktywność w systemie."})]}),(0,s.jsx)(r.Z,{isVisible:!0,onClose:()=>c.push("/")})]}):(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",flexDirection:"column",gap:"20px"},children:[(0,s.jsx)("div",{style:{fontSize:"2rem"},children:"\uD83D\uDEAB"}),(0,s.jsx)("div",{children:"Brak uprawnień administratora"})]})}},9989:function(e){e.exports={overlay:"AdminSubscriptionPanel_overlay__C8IB_",panel:"AdminSubscriptionPanel_panel__rKnSY",header:"AdminSubscriptionPanel_header__BGC9a",closeButton:"AdminSubscriptionPanel_closeButton__tQpDH",content:"AdminSubscriptionPanel_content__zAgX8",grantSection:"AdminSubscriptionPanel_grantSection__6N4zf",formGroup:"AdminSubscriptionPanel_formGroup__Cq0ee",select:"AdminSubscriptionPanel_select__N9pv4",input:"AdminSubscriptionPanel_input__wMapi",grantButton:"AdminSubscriptionPanel_grantButton__hIu_9",message:"AdminSubscriptionPanel_message__5_tku",usersSection:"AdminSubscriptionPanel_usersSection__WtdSK",usersList:"AdminSubscriptionPanel_usersList__zMvKy",userCard:"AdminSubscriptionPanel_userCard__b1Gje",userInfo:"AdminSubscriptionPanel_userInfo__cSik_",userEmail:"AdminSubscriptionPanel_userEmail__3uJDN",userName:"AdminSubscriptionPanel_userName__uz70B",subscriptionInfo:"AdminSubscriptionPanel_subscriptionInfo__FSu7B",subscriptionType:"AdminSubscriptionPanel_subscriptionType__vf8Ge",status:"AdminSubscriptionPanel_status__MQ_Ac",daysRemaining:"AdminSubscriptionPanel_daysRemaining__mA6gz",usageInfo:"AdminSubscriptionPanel_usageInfo__wBNi9"}},1163:function(e,n,i){e.exports=i(9974)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=577)}),_N_E=e.O()}]);