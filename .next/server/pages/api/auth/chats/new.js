"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/auth/chats/new";
exports.ids = ["pages/api/auth/chats/new"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "cookie":
/*!*************************!*\
  !*** external "cookie" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("cookie");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "next-auth/jwt":
/*!********************************!*\
  !*** external "next-auth/jwt" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("next-auth/jwt");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Fchats%2Fnew&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2Fchats%2Fnew.ts&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Fchats%2Fnew&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2Fchats%2Fnew.ts&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_auth_chats_new_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/auth/chats/new.ts */ \"(api)/./pages/api/auth/chats/new.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_auth_chats_new_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_auth_chats_new_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/auth/chats/new\",\n        pathname: \"/api/auth/chats/new\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_auth_chats_new_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmF1dGglMkZjaGF0cyUyRm5ldyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGYXV0aCUyRmNoYXRzJTJGbmV3LnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzBEO0FBQzFEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx5REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMseURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLz84ZTBhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvYXV0aC9jaGF0cy9uZXcudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hdXRoL2NoYXRzL25ld1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1dGgvY2hhdHMvbmV3XCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Fchats%2Fnew&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2Fchats%2Fnew.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getUserFromRequest: () => (/* binding */ getUserFromRequest)\n/* harmony export */ });\n/* harmony import */ var cookie__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! cookie */ \"cookie\");\n/* harmony import */ var cookie__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(cookie__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _jwt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./jwt */ \"(api)/./lib/jwt.ts\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth/jwt */ \"next-auth/jwt\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_auth_jwt__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./prisma */ \"(api)/./lib/prisma.ts\");\n// lib/auth.ts\n\n // your existing JWT helper\n\n\nasync function getUserFromRequest(req) {\n    // Sprawdź NextAuth token (logowanie społecznościowe)\n    try {\n        const nextAuthToken = await (0,next_auth_jwt__WEBPACK_IMPORTED_MODULE_2__.getToken)({\n            req,\n            secret: process.env.NEXTAUTH_SECRET\n        });\n        if (nextAuthToken && nextAuthToken.email) {\n            console.log(\"✅ auth.ts - NextAuth token znaleziony:\", nextAuthToken.email);\n            // Pobierz ID użytkownika z bazy danych\n            let user = await _prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                where: {\n                    email: nextAuthToken.email\n                },\n                select: {\n                    id: true,\n                    email: true\n                }\n            });\n            // Jeśli użytkownik NextAuth nie istnieje w bazie, utwórz go\n            if (!user) {\n                console.log(\"\\uD83D\\uDD27 auth.ts - Creating NextAuth user in database:\", nextAuthToken.email);\n                try {\n                    user = await _prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.create({\n                        data: {\n                            email: nextAuthToken.email,\n                            name: nextAuthToken.name || null,\n                            image: nextAuthToken.picture || null,\n                            confirmed: true,\n                            subscriptionType: null,\n                            subscriptionStart: null,\n                            subscriptionEnd: null,\n                            promotionsUsed: 0,\n                            promotionsLimit: 10\n                        },\n                        select: {\n                            id: true,\n                            email: true\n                        }\n                    });\n                    console.log(\"✅ auth.ts - NextAuth user created:\", user.email);\n                } catch (error) {\n                    console.error(\"❌ auth.ts - Failed to create NextAuth user:\", error);\n                    return null;\n                }\n            }\n            return {\n                id: user.id,\n                email: user.email\n            };\n        }\n    } catch (error) {\n        console.log(\"⚠️ auth.ts - błąd NextAuth token:\", error.message);\n    }\n    // Jeśli nie ma NextAuth token, sprawdź własny JWT token\n    const cookies = (0,cookie__WEBPACK_IMPORTED_MODULE_0__.parse)(req.headers.cookie || \"\");\n    console.log(\"\\uD83D\\uDD0D auth.ts - dostępne cookies:\", Object.keys(cookies));\n    console.log(\"\\uD83D\\uDD0D auth.ts - token cookie:\", !!cookies.token);\n    if (!cookies.token) {\n        console.log(\"❌ auth.ts - brak token\\xf3w\");\n        return null;\n    }\n    try {\n        const decoded = (0,_jwt__WEBPACK_IMPORTED_MODULE_1__.verifyToken)(cookies.token);\n        console.log(\"✅ auth.ts - JWT token zweryfikowany:\", decoded.email);\n        return decoded;\n    } catch (error) {\n        console.log(\"❌ auth.ts - błąd weryfikacji JWT tokenu:\", error.message);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvYXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUEsY0FBYztBQUVnQjtBQUNLLENBQUcsMkJBQTJCO0FBQ3pCO0FBQ1g7QUFFdEIsZUFBZUksbUJBQW1CQyxHQUFtQjtJQUMxRCxxREFBcUQ7SUFDckQsSUFBSTtRQUNGLE1BQU1DLGdCQUFnQixNQUFNSix1REFBUUEsQ0FBQztZQUNuQ0c7WUFDQUUsUUFBUUMsUUFBUUMsR0FBRyxDQUFDQyxlQUFlO1FBQ3JDO1FBQ0EsSUFBSUosaUJBQWlCQSxjQUFjSyxLQUFLLEVBQUU7WUFDeENDLFFBQVFDLEdBQUcsQ0FBQywwQ0FBMENQLGNBQWNLLEtBQUs7WUFFekUsdUNBQXVDO1lBQ3ZDLElBQUlHLE9BQU8sTUFBTVgsb0RBQVcsQ0FBQ1ksVUFBVSxDQUFDO2dCQUN0Q0MsT0FBTztvQkFBRUwsT0FBT0wsY0FBY0ssS0FBSztnQkFBQztnQkFDcENNLFFBQVE7b0JBQUVDLElBQUk7b0JBQU1QLE9BQU87Z0JBQUs7WUFDbEM7WUFFQSw0REFBNEQ7WUFDNUQsSUFBSSxDQUFDRyxNQUFNO2dCQUNURixRQUFRQyxHQUFHLENBQUMsOERBQW9EUCxjQUFjSyxLQUFLO2dCQUNuRixJQUFJO29CQUNGRyxPQUFPLE1BQU1YLG9EQUFXLENBQUNnQixNQUFNLENBQUM7d0JBQzlCQyxNQUFNOzRCQUNKVCxPQUFPTCxjQUFjSyxLQUFLOzRCQUMxQlUsTUFBTWYsY0FBY2UsSUFBSSxJQUFJOzRCQUM1QkMsT0FBT2hCLGNBQWNpQixPQUFPLElBQUk7NEJBQ2hDQyxXQUFXOzRCQUNYQyxrQkFBa0I7NEJBQ2xCQyxtQkFBbUI7NEJBQ25CQyxpQkFBaUI7NEJBQ2pCQyxnQkFBZ0I7NEJBQ2hCQyxpQkFBaUI7d0JBQ25CO3dCQUNBWixRQUFROzRCQUFFQyxJQUFJOzRCQUFNUCxPQUFPO3dCQUFLO29CQUNsQztvQkFDQUMsUUFBUUMsR0FBRyxDQUFDLHNDQUFzQ0MsS0FBS0gsS0FBSztnQkFDOUQsRUFBRSxPQUFPbUIsT0FBTztvQkFDZGxCLFFBQVFrQixLQUFLLENBQUMsK0NBQStDQTtvQkFDN0QsT0FBTztnQkFDVDtZQUNGO1lBRUEsT0FBTztnQkFDTFosSUFBSUosS0FBS0ksRUFBRTtnQkFDWFAsT0FBT0csS0FBS0gsS0FBSztZQUNuQjtRQUNGO0lBQ0YsRUFBRSxPQUFPbUIsT0FBTztRQUNkbEIsUUFBUUMsR0FBRyxDQUFDLHFDQUFxQyxNQUFpQmtCLE9BQU87SUFDM0U7SUFFQSx3REFBd0Q7SUFDeEQsTUFBTUMsVUFBVWhDLDZDQUFLQSxDQUFDSyxJQUFJNEIsT0FBTyxDQUFDQyxNQUFNLElBQUk7SUFDNUN0QixRQUFRQyxHQUFHLENBQUMsNENBQWtDc0IsT0FBT0MsSUFBSSxDQUFDSjtJQUMxRHBCLFFBQVFDLEdBQUcsQ0FBQyx3Q0FBOEIsQ0FBQyxDQUFDbUIsUUFBUUssS0FBSztJQUV6RCxJQUFJLENBQUNMLFFBQVFLLEtBQUssRUFBRTtRQUNsQnpCLFFBQVFDLEdBQUcsQ0FBQztRQUNaLE9BQU87SUFDVDtJQUVBLElBQUk7UUFDRixNQUFNeUIsVUFBVXJDLGlEQUFXQSxDQUFDK0IsUUFBUUssS0FBSztRQUN6Q3pCLFFBQVFDLEdBQUcsQ0FBQyx3Q0FBd0N5QixRQUFRM0IsS0FBSztRQUNqRSxPQUFPMkI7SUFDVCxFQUFFLE9BQU9SLE9BQU87UUFDZGxCLFFBQVFDLEdBQUcsQ0FBQyw0Q0FBNEMsTUFBaUJrQixPQUFPO1FBQ2hGLE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbGliL2F1dGgudHM/YmY3ZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBsaWIvYXV0aC50c1xuaW1wb3J0IHR5cGUgeyBOZXh0QXBpUmVxdWVzdCB9IGZyb20gJ25leHQnXG5pbXBvcnQgeyBwYXJzZSB9IGZyb20gJ2Nvb2tpZSdcbmltcG9ydCB7IHZlcmlmeVRva2VuIH0gZnJvbSAnLi9qd3QnICAgLy8geW91ciBleGlzdGluZyBKV1QgaGVscGVyXG5pbXBvcnQgeyBnZXRUb2tlbiB9IGZyb20gJ25leHQtYXV0aC9qd3QnXG5pbXBvcnQgcHJpc21hIGZyb20gJy4vcHJpc21hJ1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlckZyb21SZXF1ZXN0KHJlcTogTmV4dEFwaVJlcXVlc3QpIHtcbiAgLy8gU3ByYXdkxbogTmV4dEF1dGggdG9rZW4gKGxvZ293YW5pZSBzcG/FgmVjem5vxZtjaW93ZSlcbiAgdHJ5IHtcbiAgICBjb25zdCBuZXh0QXV0aFRva2VuID0gYXdhaXQgZ2V0VG9rZW4oeyBcbiAgICAgIHJlcSxcbiAgICAgIHNlY3JldDogcHJvY2Vzcy5lbnYuTkVYVEFVVEhfU0VDUkVUIFxuICAgIH0pXG4gICAgaWYgKG5leHRBdXRoVG9rZW4gJiYgbmV4dEF1dGhUb2tlbi5lbWFpbCkge1xuICAgICAgY29uc29sZS5sb2coJ+KchSBhdXRoLnRzIC0gTmV4dEF1dGggdG9rZW4gem5hbGV6aW9ueTonLCBuZXh0QXV0aFRva2VuLmVtYWlsKVxuICAgICAgXG4gICAgICAvLyBQb2JpZXJ6IElEIHXFvHl0a293bmlrYSB6IGJhenkgZGFueWNoXG4gICAgICBsZXQgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBlbWFpbDogbmV4dEF1dGhUb2tlbi5lbWFpbCB9LFxuICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUsIGVtYWlsOiB0cnVlIH1cbiAgICAgIH0pXG4gICAgICBcbiAgICAgIC8vIEplxZtsaSB1xbx5dGtvd25payBOZXh0QXV0aCBuaWUgaXN0bmllamUgdyBiYXppZSwgdXR3w7NyeiBnb1xuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5SnIGF1dGgudHMgLSBDcmVhdGluZyBOZXh0QXV0aCB1c2VyIGluIGRhdGFiYXNlOicsIG5leHRBdXRoVG9rZW4uZW1haWwpXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmNyZWF0ZSh7XG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIGVtYWlsOiBuZXh0QXV0aFRva2VuLmVtYWlsISxcbiAgICAgICAgICAgICAgbmFtZTogbmV4dEF1dGhUb2tlbi5uYW1lIHx8IG51bGwsXG4gICAgICAgICAgICAgIGltYWdlOiBuZXh0QXV0aFRva2VuLnBpY3R1cmUgfHwgbnVsbCxcbiAgICAgICAgICAgICAgY29uZmlybWVkOiB0cnVlLCAvLyBOZXh0QXV0aCB1xbx5dGtvd25pY3kgc8SFIGF1dG9tYXR5Y3puaWUgcG90d2llcmR6ZW5pXG4gICAgICAgICAgICAgIHN1YnNjcmlwdGlvblR5cGU6IG51bGwsXG4gICAgICAgICAgICAgIHN1YnNjcmlwdGlvblN0YXJ0OiBudWxsLFxuICAgICAgICAgICAgICBzdWJzY3JpcHRpb25FbmQ6IG51bGwsXG4gICAgICAgICAgICAgIHByb21vdGlvbnNVc2VkOiAwLFxuICAgICAgICAgICAgICBwcm9tb3Rpb25zTGltaXQ6IDEwXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlLCBlbWFpbDogdHJ1ZSB9XG4gICAgICAgICAgfSlcbiAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIGF1dGgudHMgLSBOZXh0QXV0aCB1c2VyIGNyZWF0ZWQ6JywgdXNlci5lbWFpbClcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgYXV0aC50cyAtIEZhaWxlZCB0byBjcmVhdGUgTmV4dEF1dGggdXNlcjonLCBlcnJvcilcbiAgICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICBlbWFpbDogdXNlci5lbWFpbFxuICAgICAgfVxuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmxvZygn4pqg77iPIGF1dGgudHMgLSBixYLEhWQgTmV4dEF1dGggdG9rZW46JywgKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlKVxuICB9XG5cbiAgLy8gSmXFm2xpIG5pZSBtYSBOZXh0QXV0aCB0b2tlbiwgc3ByYXdkxbogd8WCYXNueSBKV1QgdG9rZW5cbiAgY29uc3QgY29va2llcyA9IHBhcnNlKHJlcS5oZWFkZXJzLmNvb2tpZSB8fCAnJylcbiAgY29uc29sZS5sb2coJ/CflI0gYXV0aC50cyAtIGRvc3TEmXBuZSBjb29raWVzOicsIE9iamVjdC5rZXlzKGNvb2tpZXMpKVxuICBjb25zb2xlLmxvZygn8J+UjSBhdXRoLnRzIC0gdG9rZW4gY29va2llOicsICEhY29va2llcy50b2tlbilcbiAgXG4gIGlmICghY29va2llcy50b2tlbikge1xuICAgIGNvbnNvbGUubG9nKCfinYwgYXV0aC50cyAtIGJyYWsgdG9rZW7Ds3cnKVxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IGRlY29kZWQgPSB2ZXJpZnlUb2tlbihjb29raWVzLnRva2VuKSBhcyB7IGlkOiBudW1iZXI7IGVtYWlsOiBzdHJpbmcgfVxuICAgIGNvbnNvbGUubG9nKCfinIUgYXV0aC50cyAtIEpXVCB0b2tlbiB6d2VyeWZpa293YW55OicsIGRlY29kZWQuZW1haWwpXG4gICAgcmV0dXJuIGRlY29kZWRcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmxvZygn4p2MIGF1dGgudHMgLSBixYLEhWQgd2VyeWZpa2FjamkgSldUIHRva2VudTonLCAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpXG4gICAgcmV0dXJuIG51bGxcbiAgfVxufVxuIl0sIm5hbWVzIjpbInBhcnNlIiwidmVyaWZ5VG9rZW4iLCJnZXRUb2tlbiIsInByaXNtYSIsImdldFVzZXJGcm9tUmVxdWVzdCIsInJlcSIsIm5leHRBdXRoVG9rZW4iLCJzZWNyZXQiLCJwcm9jZXNzIiwiZW52IiwiTkVYVEFVVEhfU0VDUkVUIiwiZW1haWwiLCJjb25zb2xlIiwibG9nIiwidXNlciIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsInNlbGVjdCIsImlkIiwiY3JlYXRlIiwiZGF0YSIsIm5hbWUiLCJpbWFnZSIsInBpY3R1cmUiLCJjb25maXJtZWQiLCJzdWJzY3JpcHRpb25UeXBlIiwic3Vic2NyaXB0aW9uU3RhcnQiLCJzdWJzY3JpcHRpb25FbmQiLCJwcm9tb3Rpb25zVXNlZCIsInByb21vdGlvbnNMaW1pdCIsImVycm9yIiwibWVzc2FnZSIsImNvb2tpZXMiLCJoZWFkZXJzIiwiY29va2llIiwiT2JqZWN0Iiwia2V5cyIsInRva2VuIiwiZGVjb2RlZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/auth.ts\n");

/***/ }),

/***/ "(api)/./lib/jwt.ts":
/*!********************!*\
  !*** ./lib/jwt.ts ***!
  \********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   signToken: () => (/* binding */ signToken),\n/* harmony export */   verifyToken: () => (/* binding */ verifyToken)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n\nconst JWT_SECRET = process.env.JWT_SECRET;\nif (!JWT_SECRET) throw new Error(\"JWT_SECRET is missing in environment variables\");\nfunction signToken(payload, expiresIn = \"7d\") {\n    const options = {\n        expiresIn: String(expiresIn)\n    };\n    return jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().sign(payload, JWT_SECRET, options);\n}\nfunction verifyToken(token) {\n    return jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, JWT_SECRET);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvand0LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBOEI7QUFFOUIsTUFBTUMsYUFBYUMsUUFBUUMsR0FBRyxDQUFDRixVQUFVO0FBQ3pDLElBQUksQ0FBQ0EsWUFBWSxNQUFNLElBQUlHLE1BQU07QUFFMUIsU0FBU0MsVUFBVUMsT0FBNEIsRUFBRUMsWUFBNkIsSUFBSTtJQUN2RixNQUFNQyxVQUFlO1FBQUVELFdBQVdFLE9BQU9GO0lBQVc7SUFDcEQsT0FBT1Asd0RBQVEsQ0FBQ00sU0FBU0wsWUFBc0JPO0FBQ2pEO0FBRU8sU0FBU0csWUFBWUMsS0FBYTtJQUN2QyxPQUFPWiwwREFBVSxDQUFDWSxPQUFPWDtBQUMzQiIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2xpYi9qd3QudHM/ZWEyMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbidcblxuY29uc3QgSldUX1NFQ1JFVCA9IHByb2Nlc3MuZW52LkpXVF9TRUNSRVRcbmlmICghSldUX1NFQ1JFVCkgdGhyb3cgbmV3IEVycm9yKCdKV1RfU0VDUkVUIGlzIG1pc3NpbmcgaW4gZW52aXJvbm1lbnQgdmFyaWFibGVzJylcblxuZXhwb3J0IGZ1bmN0aW9uIHNpZ25Ub2tlbihwYXlsb2FkOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LCBleHBpcmVzSW46IHN0cmluZyB8IG51bWJlciA9ICc3ZCcpIHtcbiAgY29uc3Qgb3B0aW9uczogYW55ID0geyBleHBpcmVzSW46IFN0cmluZyhleHBpcmVzSW4pIH1cbiAgcmV0dXJuIGp3dC5zaWduKHBheWxvYWQsIEpXVF9TRUNSRVQgYXMgc3RyaW5nLCBvcHRpb25zKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5VG9rZW4odG9rZW46IHN0cmluZykge1xuICByZXR1cm4gand0LnZlcmlmeSh0b2tlbiwgSldUX1NFQ1JFVCBhcyBzdHJpbmcpXG59Il0sIm5hbWVzIjpbImp3dCIsIkpXVF9TRUNSRVQiLCJwcm9jZXNzIiwiZW52IiwiRXJyb3IiLCJzaWduVG9rZW4iLCJwYXlsb2FkIiwiZXhwaXJlc0luIiwib3B0aW9ucyIsIlN0cmluZyIsInNpZ24iLCJ2ZXJpZnlUb2tlbiIsInRva2VuIiwidmVyaWZ5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/jwt.ts\n");

/***/ }),

/***/ "(api)/./lib/prisma.ts":
/*!***********************!*\
  !*** ./lib/prisma.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (prisma);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE2QztBQUU3QyxNQUFNQyxTQUFTLElBQUlELHdEQUFZQTtBQUMvQixpRUFBZUMsTUFBTUEsRUFBQSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2xpYi9wcmlzbWEudHM/OTgyMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcblxuY29uc3QgcHJpc21hID0gbmV3IFByaXNtYUNsaWVudCgpXG5leHBvcnQgZGVmYXVsdCBwcmlzbWFcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJwcmlzbWEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/prisma.ts\n");

/***/ }),

/***/ "(api)/./pages/api/auth/chats/new.ts":
/*!*************************************!*\
  !*** ./pages/api/auth/chats/new.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/prisma */ \"(api)/./lib/prisma.ts\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../lib/auth */ \"(api)/./lib/auth.ts\");\n/* harmony import */ var _lib_jwt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../lib/jwt */ \"(api)/./lib/jwt.ts\");\n// pages/api/auth/chats/new.ts\n\n\n\nasync function handler(req, res) {\n    console.log(\"\\uD83D\\uDE80 Chat API called:\", req.method);\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    // Obsługa tokenu z cookie lub Authorization header\n    let userAuth = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.getUserFromRequest)(req);\n    console.log(\"\\uD83D\\uDD0D getUserFromRequest result:\", !!userAuth);\n    if (!userAuth) {\n        const authHeader = req.headers.authorization;\n        console.log(\"\\uD83D\\uDD0D Authorization header:\", !!authHeader);\n        if (authHeader && authHeader.startsWith(\"Bearer \")) {\n            const token = authHeader.substring(7);\n            console.log(\"\\uD83D\\uDD0D Token from header:\", !!token);\n            try {\n                userAuth = (0,_lib_jwt__WEBPACK_IMPORTED_MODULE_2__.verifyToken)(token);\n                console.log(\"✅ Token verified:\", userAuth?.email);\n            } catch (error) {\n                console.log(\"❌ Token verification failed:\", error);\n                return res.status(401).json({\n                    error: \"Invalid token\"\n                });\n            }\n        }\n    }\n    const { withEmail, offerId } = req.body;\n    console.log(\"\\uD83D\\uDCE8 Chat request:\", {\n        userAuth: userAuth?.email,\n        withEmail,\n        offerId\n    });\n    if (!userAuth) {\n        console.log(\"❌ No user auth - returning 401\");\n        return res.status(401).json({\n            error: \"Unauthorized\"\n        });\n    }\n    if (!withEmail) {\n        console.log(\"❌ Missing withEmail - returning 400\");\n        return res.status(400).json({\n            error: \"Missing withEmail\"\n        });\n    }\n    let you = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].user.findUnique({\n        where: {\n            email: userAuth.email\n        }\n    });\n    let other = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].user.findUnique({\n        where: {\n            email: withEmail\n        }\n    });\n    console.log(\"\\uD83D\\uDD0D Chat participants:\");\n    console.log(\"  - You (logged user):\", userAuth.email, \"-> found:\", !!you);\n    console.log(\"  - Other (offer owner):\", withEmail, \"-> found:\", !!other);\n    // Jeśli drugi użytkownik nie istnieje, spróbuj go stworzyć jako podstawowego użytkownika\n    if (!other) {\n        console.log(\"\\uD83D\\uDD27 Creating basic user for chat participant:\", withEmail);\n        try {\n            other = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].user.create({\n                data: {\n                    email: withEmail,\n                    name: withEmail.split(\"@\")[0],\n                    confirmed: false,\n                    subscriptionType: null,\n                    subscriptionStart: null,\n                    subscriptionEnd: null,\n                    promotionsUsed: 0,\n                    promotionsLimit: 10\n                }\n            });\n            console.log(\"✅ Basic user created for chat:\", other.email);\n        } catch (error) {\n            console.error(\"❌ Failed to create basic user:\", error);\n            return res.status(500).json({\n                error: \"Failed to create chat participant\"\n            });\n        }\n    }\n    if (!you || !other) {\n        console.log(\"❌ User(s) not found - you:\", !!you, \"other:\", !!other);\n        return res.status(404).json({\n            error: \"User(s) not found\"\n        });\n    }\n    // Jeśli już jest czat między tymi userami – zwracamy istniejący\n    let chat = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].chat.findFirst({\n        where: {\n            participants: {\n                some: {\n                    userId: you.id\n                }\n            },\n            AND: {\n                participants: {\n                    some: {\n                        userId: other.id\n                    }\n                }\n            }\n        }\n    });\n    if (!chat) {\n        chat = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].chat.create({\n            data: {\n                participants: {\n                    create: [\n                        {\n                            userId: you.id\n                        },\n                        {\n                            userId: other.id\n                        }\n                    ]\n                }\n            }\n        });\n    }\n    return res.status(201).json({\n        chatId: chat.id\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q2RMLFFBQVFLLEtBQUssQ0FBQyxrQ0FBa0NBO1lBQ2hELE9BQU9OLElBQUlJLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBb0M7UUFDM0U7SUFDRjtJQUVBLElBQUksQ0FBQ1ksT0FBTyxDQUFDSSxPQUFPO1FBQ2xCckIsUUFBUUMsR0FBRyxDQUFDLDhCQUE4QixDQUFDLENBQUNnQixLQUFLLFVBQVUsQ0FBQyxDQUFDSTtRQUM3RCxPQUFPdEIsSUFBSUksTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQW9CO0lBQzNEO0lBRUEsZ0VBQWdFO0lBQ2hFLElBQUkyQixPQUFPLE1BQU10Qyx3REFBVyxDQUFDdUMsU0FBUyxDQUFDO1FBQ3JDYixPQUFPO1lBQ0xjLGNBQWM7Z0JBQUVDLE1BQU07b0JBQUVDLFFBQVFuQixJQUFJb0IsRUFBRTtnQkFBQztZQUFFO1lBQ3pDQyxLQUFLO2dCQUFFSixjQUFjO29CQUFFQyxNQUFNO3dCQUFFQyxRQUFRZixNQUFNZ0IsRUFBRTtvQkFBQztnQkFBRTtZQUFFO1FBQ3REO0lBQ0Y7SUFFQSxJQUFJLENBQUNMLE1BQU07UUFDVEEsT0FBTyxNQUFNdEMsd0RBQVcsQ0FBQzRCLE1BQU0sQ0FBQztZQUM5QkMsTUFBTTtnQkFDSlcsY0FBYztvQkFDWlosUUFBUTt3QkFDTjs0QkFBRWMsUUFBUW5CLElBQUlvQixFQUFFO3dCQUFDO3dCQUNqQjs0QkFBRUQsUUFBUWYsTUFBTWdCLEVBQUU7d0JBQUM7cUJBQ3BCO2dCQUNIO1lBQ0Y7UUFDRjtJQUNGO0lBRUEsT0FBT3RDLElBQUlJLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7UUFBRW1DLFFBQVFQLEtBQUtLLEVBQUU7SUFBQztBQUNoRCIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3BhZ2VzL2FwaS9hdXRoL2NoYXRzL25ldy50cz9kZWMwIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHBhZ2VzL2FwaS9hdXRoL2NoYXRzL25ldy50c1xuaW1wb3J0IHR5cGUgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCdcbmltcG9ydCBwcmlzbWEgZnJvbSAnLi4vLi4vLi4vLi4vbGliL3ByaXNtYSdcbmltcG9ydCB7IGdldFVzZXJGcm9tUmVxdWVzdCB9IGZyb20gJy4uLy4uLy4uLy4uL2xpYi9hdXRoJ1xuaW1wb3J0IHsgdmVyaWZ5VG9rZW4gfSBmcm9tICcuLi8uLi8uLi8uLi9saWIvand0J1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKFxuICByZXE6IE5leHRBcGlSZXF1ZXN0LFxuICByZXM6IE5leHRBcGlSZXNwb25zZVxuKSB7XG4gIGNvbnNvbGUubG9nKCfwn5qAIENoYXQgQVBJIGNhbGxlZDonLCByZXEubWV0aG9kKVxuICBcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KVxuICB9XG5cbiAgLy8gT2JzxYJ1Z2EgdG9rZW51IHogY29va2llIGx1YiBBdXRob3JpemF0aW9uIGhlYWRlclxuICBsZXQgdXNlckF1dGggPSBhd2FpdCBnZXRVc2VyRnJvbVJlcXVlc3QocmVxKVxuICBjb25zb2xlLmxvZygn8J+UjSBnZXRVc2VyRnJvbVJlcXVlc3QgcmVzdWx0OicsICEhdXNlckF1dGgpXG4gIFxuICBpZiAoIXVzZXJBdXRoKSB7XG4gICAgY29uc3QgYXV0aEhlYWRlciA9IHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb25cbiAgICBjb25zb2xlLmxvZygn8J+UjSBBdXRob3JpemF0aW9uIGhlYWRlcjonLCAhIWF1dGhIZWFkZXIpXG4gICAgaWYgKGF1dGhIZWFkZXIgJiYgYXV0aEhlYWRlci5zdGFydHNXaXRoKCdCZWFyZXIgJykpIHtcbiAgICAgIGNvbnN0IHRva2VuID0gYXV0aEhlYWRlci5zdWJzdHJpbmcoNylcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SNIFRva2VuIGZyb20gaGVhZGVyOicsICEhdG9rZW4pXG4gICAgICB0cnkge1xuICAgICAgICB1c2VyQXV0aCA9IHZlcmlmeVRva2VuKHRva2VuKSBhcyB7IGlkOiBudW1iZXI7IGVtYWlsOiBzdHJpbmcgfVxuICAgICAgICBjb25zb2xlLmxvZygn4pyFIFRva2VuIHZlcmlmaWVkOicsIHVzZXJBdXRoPy5lbWFpbClcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfinYwgVG9rZW4gdmVyaWZpY2F0aW9uIGZhaWxlZDonLCBlcnJvcilcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdJbnZhbGlkIHRva2VuJyB9KVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHsgd2l0aEVtYWlsLCBvZmZlcklkIH0gPSByZXEuYm9keSBhcyB7IHdpdGhFbWFpbD86IHN0cmluZzsgb2ZmZXJJZD86IHN0cmluZyB9XG4gIGNvbnNvbGUubG9nKCfwn5OoIENoYXQgcmVxdWVzdDonLCB7IHVzZXJBdXRoOiB1c2VyQXV0aD8uZW1haWwsIHdpdGhFbWFpbCwgb2ZmZXJJZCB9KVxuXG4gIGlmICghdXNlckF1dGgpIHtcbiAgICBjb25zb2xlLmxvZygn4p2MIE5vIHVzZXIgYXV0aCAtIHJldHVybmluZyA0MDEnKVxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9KVxuICB9XG4gIGlmICghd2l0aEVtYWlsKSB7XG4gICAgY29uc29sZS5sb2coJ+KdjCBNaXNzaW5nIHdpdGhFbWFpbCAtIHJldHVybmluZyA0MDAnKVxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnTWlzc2luZyB3aXRoRW1haWwnIH0pXG4gIH1cblxuICBsZXQgeW91ID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGVtYWlsOiB1c2VyQXV0aC5lbWFpbCB9IH0pXG4gIGxldCBvdGhlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBlbWFpbDogd2l0aEVtYWlsIH0gfSlcbiAgXG4gIGNvbnNvbGUubG9nKCfwn5SNIENoYXQgcGFydGljaXBhbnRzOicpXG4gIGNvbnNvbGUubG9nKCcgIC0gWW91IChsb2dnZWQgdXNlcik6JywgdXNlckF1dGguZW1haWwsICctPiBmb3VuZDonLCAhIXlvdSlcbiAgY29uc29sZS5sb2coJyAgLSBPdGhlciAob2ZmZXIgb3duZXIpOicsIHdpdGhFbWFpbCwgJy0+IGZvdW5kOicsICEhb3RoZXIpXG4gIFxuICAvLyBKZcWbbGkgZHJ1Z2kgdcW8eXRrb3duaWsgbmllIGlzdG5pZWplLCBzcHLDs2J1aiBnbyBzdHdvcnp5xIcgamFrbyBwb2RzdGF3b3dlZ28gdcW8eXRrb3duaWthXG4gIGlmICghb3RoZXIpIHtcbiAgICBjb25zb2xlLmxvZygn8J+UpyBDcmVhdGluZyBiYXNpYyB1c2VyIGZvciBjaGF0IHBhcnRpY2lwYW50OicsIHdpdGhFbWFpbClcbiAgICB0cnkge1xuICAgICAgb3RoZXIgPSBhd2FpdCBwcmlzbWEudXNlci5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgZW1haWw6IHdpdGhFbWFpbCxcbiAgICAgICAgICBuYW1lOiB3aXRoRW1haWwuc3BsaXQoJ0AnKVswXSwgLy8gVcW8eWogY3rEmcWbY2kgcHJ6ZWQgQCBqYWtvIG5hend5XG4gICAgICAgICAgY29uZmlybWVkOiBmYWxzZSwgLy8gTmllIHBvdHdpZXJkem9ueSwgYm8gdG8gdHlsa28gZW1haWwga29udGFrdG93eVxuICAgICAgICAgIHN1YnNjcmlwdGlvblR5cGU6IG51bGwsXG4gICAgICAgICAgc3Vic2NyaXB0aW9uU3RhcnQ6IG51bGwsXG4gICAgICAgICAgc3Vic2NyaXB0aW9uRW5kOiBudWxsLFxuICAgICAgICAgIHByb21vdGlvbnNVc2VkOiAwLFxuICAgICAgICAgIHByb21vdGlvbnNMaW1pdDogMTBcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIGNvbnNvbGUubG9nKCfinIUgQmFzaWMgdXNlciBjcmVhdGVkIGZvciBjaGF0OicsIG90aGVyLmVtYWlsKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgRmFpbGVkIHRvIGNyZWF0ZSBiYXNpYyB1c2VyOicsIGVycm9yKVxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdGYWlsZWQgdG8gY3JlYXRlIGNoYXQgcGFydGljaXBhbnQnIH0pXG4gICAgfVxuICB9XG4gIFxuICBpZiAoIXlvdSB8fCAhb3RoZXIpIHtcbiAgICBjb25zb2xlLmxvZygn4p2MIFVzZXIocykgbm90IGZvdW5kIC0geW91OicsICEheW91LCAnb3RoZXI6JywgISFvdGhlcilcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ1VzZXIocykgbm90IGZvdW5kJyB9KVxuICB9XG5cbiAgLy8gSmXFm2xpIGp1xbwgamVzdCBjemF0IG1pxJlkenkgdHltaSB1c2VyYW1pIOKAkyB6d3JhY2FteSBpc3RuaWVqxIVjeVxuICBsZXQgY2hhdCA9IGF3YWl0IHByaXNtYS5jaGF0LmZpbmRGaXJzdCh7XG4gICAgd2hlcmU6IHtcbiAgICAgIHBhcnRpY2lwYW50czogeyBzb21lOiB7IHVzZXJJZDogeW91LmlkIH0gfSxcbiAgICAgIEFORDogeyBwYXJ0aWNpcGFudHM6IHsgc29tZTogeyB1c2VySWQ6IG90aGVyLmlkIH0gfSB9LFxuICAgIH0sXG4gIH0pXG5cbiAgaWYgKCFjaGF0KSB7XG4gICAgY2hhdCA9IGF3YWl0IHByaXNtYS5jaGF0LmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIHBhcnRpY2lwYW50czoge1xuICAgICAgICAgIGNyZWF0ZTogW1xuICAgICAgICAgICAgeyB1c2VySWQ6IHlvdS5pZCB9LFxuICAgICAgICAgICAgeyB1c2VySWQ6IG90aGVyLmlkIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSlcbiAgfVxuXG4gIHJldHVybiByZXMuc3RhdHVzKDIwMSkuanNvbih7IGNoYXRJZDogY2hhdC5pZCB9KVxufVxuIl0sIm5hbWVzIjpbInByaXNtYSIsImdldFVzZXJGcm9tUmVxdWVzdCIsInZlcmlmeVRva2VuIiwiaGFuZGxlciIsInJlcSIsInJlcyIsImNvbnNvbGUiLCJsb2ciLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJ1c2VyQXV0aCIsImF1dGhIZWFkZXIiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInN0YXJ0c1dpdGgiLCJ0b2tlbiIsInN1YnN0cmluZyIsImVtYWlsIiwid2l0aEVtYWlsIiwib2ZmZXJJZCIsImJvZHkiLCJ5b3UiLCJ1c2VyIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwib3RoZXIiLCJjcmVhdGUiLCJkYXRhIiwibmFtZSIsInNwbGl0IiwiY29uZmlybWVkIiwic3Vic2NyaXB0aW9uVHlwZSIsInN1YnNjcmlwdGlvblN0YXJ0Iiwic3Vic2NyaXB0aW9uRW5kIiwicHJvbW90aW9uc1VzZWQiLCJwcm9tb3Rpb25zTGltaXQiLCJjaGF0IiwiZmluZEZpcnN0IiwicGFydGljaXBhbnRzIiwic29tZSIsInVzZXJJZCIsImlkIiwiQU5EIiwiY2hhdElkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/auth/chats/new.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Fchats%2Fnew&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2Fchats%2Fnew.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();