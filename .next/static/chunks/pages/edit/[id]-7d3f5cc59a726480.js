(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[143],{6239:function(e,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/edit/[id]",function(){return a(2662)}])},2662:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return EditOffer}});var i=a(5893),o=a(7294),t=a(1163),l=a(1372),s=a(2645),r=a(794),c=a(1910),d=a.n(c);function EditOffer(){let e=(0,t.useRouter)(),{id:n}=e.query,[a,c]=(0,o.useState)(null),[u,h]=(0,o.useState)(!1);(0,o.useEffect)(()=>{n&&fetch("/api/offers/".concat(n)).then(e=>e.json()).then(e=>{c(e)}).catch(e=>{console.error("Error fetching offer:",e),alert("Błąd podczas pobierania ogłoszenia")})},[n]),(0,o.useEffect)(()=>{a&&handleLocationChange()},[null==a?void 0:a.locationProvince,null==a?void 0:a.locationCity,null==a?void 0:a.locationDetails]);let handleLocationChange=()=>{if(!a)return;let e=[];a.locationCity&&e.push(a.locationCity),a.locationProvince&&e.push(a.locationProvince),a.locationDetails&&e.push(a.locationDetails),c({...a,location:e.join(", ")})},handleSubmit=async i=>{i.preventDefault(),h(!0);try{let i=await fetch("/api/offers/".concat(n),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)});if(i.ok)alert("Ogłoszenie zostało zaktualizowane!"),e.push("/profile");else{let e=await i.json();console.error("API Error:",e),alert("Błąd: ".concat(e.error||"Nie udało się zaktualizować ogłoszenia"))}}catch(e){console.error("Network Error updating offer:",e),alert("Wystąpił błąd sieci podczas aktualizacji ogłoszenia. Sprawdź połączenie internetowe.")}finally{h(!1)}},handleInputChange=e=>{let{name:n,value:i,type:o}=e.target,t="number"===o?parseFloat(i)||0:i;c({...a,[n]:t})};return a?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.Z,{}),(0,i.jsx)("div",{className:d().pageWrapper,style:{minHeight:"100vh",padding:"20px 0"},children:(0,i.jsxs)("form",{className:d().addOfferForm,onSubmit:handleSubmit,style:{maxWidth:"800px",margin:"0 auto"},children:[(0,i.jsx)("h1",{style:{textAlign:"center",marginBottom:"30px"},children:"Edytuj ogłoszenie"}),(0,i.jsxs)("div",{className:d().formGrid,children:[(0,i.jsxs)("div",{className:d().formGroup,children:[(0,i.jsx)("label",{children:"Tytuł ogłoszenia *"}),(0,i.jsx)("input",{type:"text",name:"title",value:a.title||"",onChange:handleInputChange,required:!0})]}),(0,i.jsxs)("div",{className:d().formGroup,children:[(0,i.jsx)("label",{children:"Opis *"}),(0,i.jsx)("textarea",{name:"description",value:a.description||"",onChange:handleInputChange,rows:4,required:!0})]}),(0,i.jsxs)("div",{className:d().formGroup,children:[(0,i.jsx)("label",{children:"Cena (zł) *"}),(0,i.jsx)("input",{type:"number",name:"price",value:a.price||"",onChange:handleInputChange,min:"0",step:"0.01",required:!0})]}),(0,i.jsxs)("div",{className:d().formGroup,children:[(0,i.jsx)("label",{children:"Kategoria * (nie można zmieniać)"}),(0,i.jsxs)("select",{name:"category",value:a.category||"",onChange:handleInputChange,disabled:!0,required:!0,style:{opacity:.6,cursor:"not-allowed"},children:[(0,i.jsx)("option",{value:"",children:"Wybierz kategorię"}),Object.entries(s.aA).map(e=>{let[n,a]=e;return(0,i.jsx)("option",{value:n,children:a.name},n)})]}),(0,i.jsx)("div",{style:{fontSize:"0.85rem",color:"#666",marginTop:"4px"},children:"ℹ️ Ze względ\xf3w bezpieczeństwa kategoria nie może być zmieniana po utworzeniu ogłoszenia"})]}),(0,i.jsxs)("div",{className:d().formGroup,children:[(0,i.jsx)("label",{children:"Lokalizacja *"}),(0,i.jsxs)("div",{className:d().locationSection,children:[(0,i.jsxs)("div",{className:d().locationRow,children:[(0,i.jsxs)("div",{className:d().locationField,children:[(0,i.jsx)("label",{children:"Wojew\xf3dztwo"}),(0,i.jsxs)("select",{name:"locationProvince",value:a.locationProvince||"",onChange:e=>{c({...a,locationProvince:e.target.value,locationCity:""})},required:!0,children:[(0,i.jsx)("option",{value:"",children:"Wybierz wojew\xf3dztwo"}),r.LE.map(e=>(0,i.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]})]}),(0,i.jsxs)("div",{className:d().locationField,children:[(0,i.jsx)("label",{children:"Miasto"}),(0,i.jsxs)("select",{name:"locationCity",value:a.locationCity||"",onChange:handleInputChange,disabled:!a.locationProvince,required:!0,children:[(0,i.jsx)("option",{value:"",children:"Wybierz miasto"}),a.locationProvince&&(0,r._u)(a.locationProvince).map(e=>(0,i.jsx)("option",{value:e,children:e},e))]})]})]}),(0,i.jsx)("div",{className:d().locationRow,children:(0,i.jsxs)("div",{className:d().locationField,children:[(0,i.jsx)("label",{children:"Szczeg\xf3ły (opcjonalne)"}),(0,i.jsx)("input",{type:"text",name:"locationDetails",value:a.locationDetails||"",onChange:handleInputChange,placeholder:"Dzielnica, ulica..."})]})})]})]}),(0,i.jsxs)("div",{className:d().formGroup,children:[(0,i.jsx)("label",{children:"Imię i nazwisko *"}),(0,i.jsx)("input",{type:"text",name:"contactName",value:a.contactName||"",onChange:handleInputChange,required:!0})]}),(0,i.jsxs)("div",{className:d().formGroup,children:[(0,i.jsx)("label",{children:"Email * - wpisz email zgodny z emailem z używanego konta"}),(0,i.jsx)("input",{type:"email",name:"contactEmail",value:a.contactEmail||"",onChange:handleInputChange,required:!0})]}),(0,i.jsxs)("div",{className:d().formGroup,children:[(0,i.jsx)("label",{children:"Telefon"}),(0,i.jsx)("input",{type:"tel",name:"contactPhone",value:a.contactPhone||"",onChange:handleInputChange})]})]}),(0,i.jsxs)("div",{className:d().stepButtons,style:{justifyContent:"center",gap:"20px",marginTop:"30px"},children:[(0,i.jsx)("button",{type:"button",className:d().backBtn,onClick:()=>e.push("/profile"),children:"Anuluj"}),(0,i.jsx)("button",{type:"submit",className:d().submitBtn,disabled:u,children:u?"Zapisywanie...":"Zapisz zmiany"})]})]})})]}):(0,i.jsx)("div",{style:{padding:"20px",textAlign:"center"},children:"Ładuję..."})}}},function(e){e.O(0,[424,68,372,379,774,888,179],function(){return e(e.s=6239)}),_N_E=e.O()}]);