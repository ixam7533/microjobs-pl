exports.id=1372,exports.ids=[1372],exports.modules={28:e=>{e.exports={header:"Header_header__KwdYD",inner:"Header_inner__DLT3k",switch:"Header_switch__YAo6v",overlay:"Header_overlay__QkI_s",video:"Header_video__gpAzI",nightBackground:"Header_nightBackground__AtIcU",nightGradient:"Header_nightGradient__1XFaj",lightBackground:"Header_lightBackground___GEX2",lightGradient:"Header_lightGradient__9PbKz",tint:"Header_tint__p7TRw",top:"Header_top__ELEid",logo:"Header_logo____uDV",nav:"Header_nav__tNWGY",proSection:"Header_proSection__zsRPC",btn:"Header_btn__RDhAL",adminBtn:"Header_adminBtn__dDudE",proBtn:"Header_proBtn__o3iy_",userMenu:"Header_userMenu__B7S15",email:"Header_email__i4cac",hero:"Header_hero__DunNT",wave:"Header_wave__9DzMa"}},3252:e=>{e.exports={notificationWrapper:"NotificationBadge_notificationWrapper__ufdpL",badge:"NotificationBadge_badge__vK5Yf",pulse:"NotificationBadge_pulse__rJDPG"}},8648:e=>{e.exports={promotionCounter:"PromotionCounter_promotionCounter__Qej9E",miniCounter:"PromotionCounter_miniCounter__s_qZ4",miniIcon:"PromotionCounter_miniIcon__tqN6q",miniText:"PromotionCounter_miniText___ZNF4",counterBadge:"PromotionCounter_counterBadge__AyMnt",counterIcon:"PromotionCounter_counterIcon___myaK",counterText:"PromotionCounter_counterText__Ee6LE",counterLabel:"PromotionCounter_counterLabel__1nXHL",subscriptionBadge:"PromotionCounter_subscriptionBadge__qliiY",pulse:"PromotionCounter_pulse__GukTU"}},1372:(e,t,o)=>{"use strict";o.d(t,{Z:()=>Header});var n=o(997),r=o(6689),a=o(1163),i=o(1664),s=o.n(i),c=o(1649),l=o(28),u=o.n(l),d=o(9816),m=o.n(d),h=o(6459),p=o(5040),_=o(3504);function ThemeSwitch(){let[e,t]=(0,r.useState)("natura");return(0,r.useEffect)(()=>{let e=localStorage.getItem("theme");window.matchMedia("(prefers-color-scheme: dark)").matches;let o=e||"natura";t(o),document.documentElement.setAttribute("data-theme",o)},[]),(0,n.jsxs)("button",{onClick:()=>{let o=["natura","dark","light","night"],n=o.indexOf(e),r=o[(n+1)%o.length];t(r),document.documentElement.setAttribute("data-theme",r),localStorage.setItem("theme",r)},className:"jsx-3c8afe78bed0d352 theme-button",children:[(()=>{switch(e){case"dark":default:return n.jsx(h.Z,{className:"icon"});case"light":return n.jsx(p.Z,{className:"icon"});case"night":return n.jsx(_.Z,{className:"icon"});case"natura":return n.jsx("span",{className:"icon",children:"\uD83C\uDF3F"})}})(),n.jsx("span",{className:"jsx-3c8afe78bed0d352 theme-label",children:e}),n.jsx(m(),{id:"3c8afe78bed0d352",children:".theme-button.jsx-3c8afe78bed0d352{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:8px;padding:8px 12px;background:var(--bg-color);border:2px solid var(--text-color);-webkit-border-radius:20px;-moz-border-radius:20px;border-radius:20px;cursor:pointer;-webkit-transition:all.3s ease;-moz-transition:all.3s ease;-o-transition:all.3s ease;transition:all.3s ease;color:var(--text-color);font-size:12px;font-weight:500;text-transform:uppercase}.theme-button.jsx-3c8afe78bed0d352:hover{background:var(--text-color);color:var(--bg-color)}.icon.jsx-3c8afe78bed0d352{width:16px;height:16px;color:currentColor}.theme-label.jsx-3c8afe78bed0d352{font-size:11px;letter-spacing:.5px}"})]})}var g=o(8648),x=o.n(g);function PromotionCounter({className:e}){let[t,o]=(0,r.useState)(null);(0,r.useEffect)(()=>{fetchPromotionData();let e=setInterval(fetchPromotionData,3e4);return()=>clearInterval(e)},[]);let fetchPromotionData=async()=>{try{console.log("\uD83D\uDD04 PromotionCounter: Fetching data...");let e=new Date().getTime(),t=await fetch(`/api/subscriptions/status?t=${e}`,{credentials:"include"});if(console.log("\uD83D\uDCE1 PromotionCounter: Response status:",t.status),t.ok){let e=await t.json();console.log("\uD83D\uDCCA PromotionCounter: Received raw data:",JSON.stringify(e,null,2));try{if(e&&e.subscription&&e.subscription.isActive){console.log("✅ PromotionCounter: Setting active subscription data");let t={promotionsUsed:Number(e.subscription.promotionsUsed)||0,promotionsLimit:Number(e.subscription.promotionsLimit)||0,subscriptionType:e.subscription.type||null};console.log("\uD83C\uDFAF PromotionCounter: Setting state to:",t),o(t)}else console.log("❌ PromotionCounter: No active subscription")}catch(e){console.error("Error parsing subscription data:",e)}}else console.log("❌ PromotionCounter: Response not ok:",t.status)}catch(e){console.error("❌ PromotionCounter: Error fetching promotion data:",e)}};if(!t)return console.log("⏳ PromotionCounter: No promotion data yet"),null;let a="PRO_PLUS"===t.subscriptionType,i=a?3:t.promotionsLimit||0,s=t.promotionsUsed||0,c=Math.max(0,i-s);console.log("\uD83C\uDFAF PromotionCounter: Rendering with data:",{remaining:c,limit:i,isProPlus:a,type:t.subscriptionType});let l=Number.isFinite(c)?c.toString():"0",u=Number.isFinite(i)?i.toString():"0";return n.jsx("div",{className:`${x().promotionCounter} ${e||""}`,children:(0,n.jsxs)("div",{className:x().miniCounter,children:[n.jsx("span",{className:x().miniIcon,children:"\uD83C\uDFAF"}),n.jsx("span",{className:x().miniText,children:`${l}/${u}`})]})})}var b=o(3252),f=o.n(b);function ChatNotificationBadge({children:e}){let[t,o]=(0,r.useState)(0);return(0,r.useEffect)(()=>{let fetchUnreadCount=async()=>{try{console.log("\uD83D\uDCAC ChatNotificationBadge: Fetching unread count...");let e=await fetch("/api/messages/unread-count",{credentials:"include"});if(console.log("\uD83D\uDCAC ChatNotificationBadge: Response status:",e.status),e.ok){let t=await e.json();console.log("\uD83D\uDCAC ChatNotificationBadge: Received data:",t),o(t.unreadCount)}else{let t=await e.json();console.log("\uD83D\uDCAC ChatNotificationBadge: Error response:",t)}}catch(e){console.error("\uD83D\uDCAC ChatNotificationBadge: Error fetching unread count:",e)}};fetchUnreadCount();let e=setInterval(fetchUnreadCount,3e4);return()=>clearInterval(e)},[]),(0,n.jsxs)("div",{className:f().notificationWrapper,children:[e,t>0&&n.jsx("span",{className:f().badge,children:t>99?"99+":t})]})}var j=o(3130);function Header(){let[e,t]=(0,r.useState)(null),[o,i]=(0,r.useState)("dark"),[l,d]=(0,r.useState)(!1),m=(0,a.useRouter)();(0,r.useEffect)(()=>{fetch("/api/auth/me").then(async e=>{if(!e.ok)return null;try{return await e.json()}catch{return console.error("Invalid JSON from /api/auth/me"),null}}).then(e=>{e?.user&&t(e.user)}).catch(e=>console.error("Network error on /api/auth/me:",e));let e=new MutationObserver(()=>{let e=document.documentElement.getAttribute("data-theme")||"dark";i(e)});e.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]});let o=document.documentElement.getAttribute("data-theme")||"dark";return i(o),()=>e.disconnect()},[]);let handleLogout=async()=>{try{let e=await fetch("/api/auth/logout",{method:"POST"});e.ok?t(null):console.error("JWT Logout failed:",e.status),await (0,c.signOut)({redirect:!1}),m.replace("/")}catch(e){console.error("Network error on logout:",e)}};return(0,n.jsxs)("header",{className:u().header,"data-header":"true",children:[(0,n.jsxs)("div",{className:u().overlay,children:[(()=>{switch(o){case"light":return n.jsx("div",{className:u().lightBackground});case"dark":default:return n.jsx("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:u().video,children:n.jsx("source",{src:"/smoke.mp4",type:"video/mp4"})});case"night":return n.jsx("div",{className:u().nightBackground})}})(),n.jsx("div",{className:u().tint})]}),(0,n.jsxs)("div",{className:u().top,children:[n.jsx(ThemeSwitch,{}),n.jsx(s(),{href:"/",className:u().logo,children:n.jsx("span",{children:"MicroJobs"})}),(0,n.jsxs)("nav",{className:u().nav,children:[(0,n.jsxs)("div",{className:u().proSection,children:[n.jsx(s(),{href:"/pro",className:u().proBtn,children:"⭐ PRO"}),e&&n.jsx(PromotionCounter,{})]}),e?(0,n.jsxs)(n.Fragment,{children:[n.jsx(s(),{href:"/add-new",className:u().btn,children:"Dodaj ogłoszenie"}),(e.isAdmin||"microjobsj7@gmail.com"===e.email)&&n.jsx("button",{onClick:()=>d(!0),className:`${u().btn} ${u().adminBtn}`,title:"Panel Administratora",children:"\uD83D\uDC51 Admin"}),n.jsx(ChatNotificationBadge,{children:n.jsx(s(),{href:"/profile",className:u().btn,children:"M\xf3j profil"})}),(0,n.jsxs)("div",{className:u().userMenu,children:[n.jsx("span",{className:u().email,children:e.email}),n.jsx("button",{onClick:handleLogout,className:u().btn,children:"Wyloguj"})]})]}):(0,n.jsxs)(n.Fragment,{children:[n.jsx(s(),{href:"/login",className:u().btn,children:"Logowanie"}),n.jsx(s(),{href:"/register",className:u().btn,children:"Rejestracja"})]})]})]}),(0,n.jsxs)("div",{className:u().hero,children:[n.jsx("h1",{children:"Zarabiaj w wolnej chwili"}),n.jsx("p",{children:"Prosto, lokalnie, efektywnie — szukaj i oferuj pracę."})]}),n.jsx("div",{className:u().wave,children:n.jsx("svg",{viewBox:"0 0 1440 40",preserveAspectRatio:"none",children:n.jsx("path",{d:"M0,20 C120,40 240,0 360,20 C480,40 600,0 720,20 C840,40 960,0 1080,20 C1200,40 1320,0 1440,20 L1440,40 L0,40 Z",fill:"var(--color-gray)"})})}),n.jsx(j.Z,{isVisible:l,onClose:()=>d(!1)})]})}}};