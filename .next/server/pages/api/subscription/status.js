"use strict";(()=>{var e={};e.id=1456,e.ids=[1456],e.modules={3524:e=>{e.exports=require("@prisma/client")},614:e=>{e.exports=require("next-auth/jwt")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7907:(e,t,r)=>{r.r(t),r.d(t,{config:()=>p,default:()=>d,routeModule:()=>c});var s={};r.r(s),r.d(s,{default:()=>handler});var i=r(1802),n=r(7153),a=r(6249),u=r(614),o=r(5066);async function handler(e,t){if("GET"!==e.method)return t.status(405).json({error:"Metoda niedozwolona"});try{let r=await (0,u.getToken)({req:e});if(!r?.email)return t.status(401).json({error:"Musisz być zalogowany"});let s=await o.Z.user.findUnique({where:{email:r.email},include:{subscriptions:{where:{status:"ACTIVE"},orderBy:{createdAt:"desc"},take:1}}});if(!s)return t.status(404).json({error:"Użytkownik nie znaleziony"});let i=new Date,n=s.subscriptionEnd&&s.subscriptionEnd>i,a=s.subscriptions.length>0?s.subscriptions[0]:null;return t.status(200).json({hasSubscription:n,subscriptionType:n?s.subscriptionType:null,subscriptionStart:s.subscriptionStart,subscriptionEnd:s.subscriptionEnd,autoRenew:a?.autoRenew||!1,daysRemaining:n?Math.ceil((s.subscriptionEnd.getTime()-i.getTime())/864e5):0})}catch(e){return console.error("Błąd podczas pobierania statusu subskrypcji:",e),t.status(500).json({error:"Błąd serwera"})}}let d=(0,a.l)(s,"default"),p=(0,a.l)(s,"config"),c=new i.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/subscription/status",pathname:"/api/subscription/status",bundlePath:"",filename:""},userland:s})},5066:(e,t,r)=>{r.d(t,{Z:()=>n});var s=r(3524);let i=new s.PrismaClient,n=i}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[4222],()=>__webpack_exec__(7907));module.exports=r})();