"use strict";(()=>{var e={};e.id=2478,e.ids=[2478],e.modules={3524:e=>{e.exports=require("@prisma/client")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},8691:(e,t,a)=>{a.r(t),a.d(t,{config:()=>o,default:()=>l,routeModule:()=>u});var r={};a.r(r),a.d(r,{default:()=>handler});var n=a(1802),i=a(7153),s=a(6249),d=a(5066);async function handler(e,t){if("GET"!==e.method)return t.status(405).json({message:"Method not allowed"});try{let{userEmail:a}=e.query;if(!a)return t.status(400).json({message:"Email użytkownika jest wymagany"});let r=await d.Z.user.findUnique({where:{email:a}});if(!r)return t.status(404).json({message:"Użytkownik nie znaleziony"});let n=await d.Z.rating.findMany({where:{reviewedId:r.id},include:{reviewer:{select:{email:!0,name:!0}},offer:{select:{id:!0,title:!0}}},orderBy:{createdAt:"desc"}}),i=n.length>0?n.reduce((e,t)=>e+t.rating,0)/n.length:0;t.status(200).json({ratings:n,averageRating:Math.round(10*i)/10,totalRatings:n.length})}catch(e){console.error("Błąd pobierania ocen:",e),t.status(500).json({message:"Wewnętrzny błąd serwera"})}}let l=(0,s.l)(r,"default"),o=(0,s.l)(r,"config"),u=new n.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/ratings/get",pathname:"/api/ratings/get",bundlePath:"",filename:""},userland:r})},5066:(e,t,a)=>{a.d(t,{Z:()=>i});var r=a(3524);let n=new r.PrismaClient,i=n}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[4222],()=>__webpack_exec__(8691));module.exports=a})();