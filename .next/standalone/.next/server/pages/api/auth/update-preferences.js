"use strict";(()=>{var e={};e.id=9822,e.ids=[9822],e.modules={9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},630:(e,r,n)=>{n.r(r),n.d(r,{config:()=>d,default:()=>u,routeModule:()=>l});var s={};n.r(s),n.d(s,{default:()=>handler});var t=n(1802),a=n(7153),i=n(6249),o=n(298);async function handler(e,r){if("POST"!==e.method)return r.status(405).json({message:"Method not allowed"});try{let n=e.headers.authorization?.replace("Bearer ","")||e.cookies.token;if(!n)return r.status(401).json({message:"Nie jesteś zalogowany"});let s=(0,o.W)(n);if(!s)return r.status(401).json({message:"Nieprawidłowy token"});let{emailNotifications:t,theme:a,language:i}=e.body;r.status(200).json({message:"Ustawienia zostały zapisane pomyślnie",preferences:{emailNotifications:t,theme:a,language:i}})}catch(e){console.error("Błąd zapisywania ustawień:",e),r.status(500).json({message:"Wewnętrzny błąd serwera"})}}let u=(0,i.l)(s,"default"),d=(0,i.l)(s,"config"),l=new t.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/auth/update-preferences",pathname:"/api/auth/update-preferences",bundlePath:"",filename:""},userland:s})},298:(e,r,n)=>{n.d(r,{W:()=>verifyToken,f:()=>signToken});var s=n(9344),t=n.n(s);let a=process.env.JWT_SECRET;if(!a)throw Error("JWT_SECRET is missing in environment variables");function signToken(e,r="7d"){let n={expiresIn:String(r)};return t().sign(e,a,n)}function verifyToken(e){return t().verify(e,a)}}};var r=require("../../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),n=r.X(0,[4222],()=>__webpack_exec__(630));module.exports=n})();